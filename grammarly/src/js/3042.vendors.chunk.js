(self.webpackChunk=self.webpackChunk||[]).push([[3042],{83042:(e,t,n)=>{n.d(t,{E:()=>J,G:()=>se});var r,i,o,u=n(55289),s=n(14537),a=n(13058),c=n(96031),d=n(46426),f=n(59802),l=n(45920),v=n(56769),h=n(25394),p=n(40860),m=n(20401),I=n(48765),g=n(57312),y=n(32559),w=n(22156),b=n(71303),S=n(35677),_=n(74719),R=n(18009),A=n(45508);function U(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function O(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o=[],u=!0,s=!1;try{for(n=n.call(e);!(u=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);u=!0);}catch(e){s=!0,i=e}finally{try{u||null==n.return||n.return()}finally{if(s)throw i}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return U(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return U(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(i=r||(r={})).iso=function(){return A.k4()},i.empty=function(){return{sduiQueue:new Map}},i.removeAllBySduiId=function(e){return function(t){return(0,a.zG)(r.toQueueValuesArray(t),m.hX((function(t){return 0===t.id.indexOf("".concat(e.event.sduiRootId,"_"))})),(function(e){return r.removeItems(e)(t),e}))}},i.removeEarlierItemsBySduiId=function(e){return function(t){return(0,a.zG)(r.toQueueValuesArray(t),m.hX((function(t){return 0===t.id.indexOf("".concat(e.event.sduiRootId,"_"))&&t.order<e.order})),(function(e){return r.removeItems(e)(t),e}))}},i.addItem=function(e){return function(t){t.sduiQueue.set(e.id,e)}},i.removeItems=function(e){return function(t){e.forEach((function(e){return t.sduiQueue.delete(e.id)}))}},i.toQueueValuesArray=function(e){return Array.from(e.sduiQueue.values())},i.size=function(e){return e.sduiQueue.size},function(e){var t,n,i,o=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)};i=0,(n="QueueCounter")in(t=o)?Object.defineProperty(t,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[n]=i;e.show={show:function(e){return Array.from(r.iso().unwrap(e).sduiQueue.entries()).map((function(e){var t=O(e,2),n=t[0],r=t[1];return"".concat(n," - { id: ").concat(r.id," sduiRootId: ").concat(r.event.sduiRootId,", kind: ").concat(r.event.kind)})).join(";\n")}};!function(e){var t;!function(e){e.from=function(e){return"".concat(e)}}(t=e.Id||(e.Id={}));e.fromEvent=function(e){return{id:t.from("".concat(e.sduiRootId,"_").concat(++o.QueueCounter)),order:o.QueueCounter,event:e}}}(e.Item||(e.Item={}));e.empty=function(){return r.iso().wrap(r.empty())},e.removeAllBySduiId=function(e){return function(t){return(0,a.zG)(r.iso().unwrap(t),r.removeAllBySduiId(e))}},e.addItem=function(e){return function(t){return(0,a.zG)(r.iso().unwrap(t),r.addItem(e))}},e.removeItems=function(e){return function(t){return(0,a.zG)(r.iso().unwrap(t),r.removeItems(e))}},e.removeEarlierItemsBySduiId=function(e){return function(t){return(0,a.zG)(r.iso().unwrap(t),r.removeEarlierItemsBySduiId(e))}},e.toQueueValuesArray=function(e){return(0,a.zG)(r.iso().unwrap(e),r.toQueueValuesArray)},e.size=function(e){return(0,a.zG)(r.iso().unwrap(e),r.size)}}(o||(o={}));var D=n(78271),E=n(71094),P=n(62341),k=n(45327),j=n(37662),G=n(58013),z=n(5621),C=n(78615),M=n(95590),F=n(13650),T=n(5314),V=n(68910),Q=n(82817),x=n(24613),B=n(44127),K=n(50683),N=n(75449),L=n(93361),q=n(56014),X=n(74525);function W(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var J,Z=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Y(this,"_globalPartsState",c.h.create(new Map)),Y(this,"_subs",new M.w.Keeper),Y(this,"globalPartsAvailable",this._globalPartsState.view((function(e){return 0!==e.size}))),Y(this,"getGlobalPartById",(function(e){return h.ij(n._globalPartsState.get().get(_.j.Item.Id.from(e)))})),this._subs.push(t.pipe(T.U((function(e){return D.a.reduce(new Map,(function(e,t){return"globalPart"===t.content.type&&e.set(t.id,t.content),e}))(e)}))).subscribe(X.wW(this._globalPartsState)))}var t,n,r;return t=e,(n=[{key:"dispose",value:function(){this._subs.dispose()}}])&&W(t.prototype,n),r&&W(t,r),e}();function $(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function H(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ee(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function te(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ne(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){te(e,t,n[t])}))}return e}function re(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function ie(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o=[],u=!0,s=!1;try{for(n=n.call(e);!(u=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);u=!0);}catch(e){s=!0,i=e}finally{try{u||null==n.return||n.return()}finally{if(s)throw i}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return $(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}!function(e){e.create=function(e,t){return{card:e,parentStrongAlertRef:t}},e.isAssistantCardContent=function(e){return"assistantCard"===e.card.type},e.isInlineCardContent=function(e){return"inlineCard"===e.card.type}}(J||(J={}));var oe,ue,se=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new q.J,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:P.F(100).pipe(k.O(0)),A=arguments.length>4&&void 0!==arguments[4]?arguments[4]:j.f,U=this;H(this,e),te(this,"alertIdResolver",void 0),te(this,"popoverManager",void 0),te(this,"_sduiEventsBufferNotifier",void 0),te(this,"_sduiEventsBuffer",void 0),te(this,"_state",void 0),te(this,"state",void 0),te(this,"globalPartManager",void 0),te(this,"_unresolvedItemsQueueSize",void 0),te(this,"unresolvedItemsQueueSize",void 0),te(this,"_onAlertsRefEmpty",void 0),te(this,"_removedAlerts",void 0),te(this,"_removedRoot",void 0),te(this,"_switchView",void 0),te(this,"_sessionEvents",void 0),te(this,"_reviseSduiQueue",void 0),te(this,"_flush",void 0),te(this,"_flushViewSwitch",void 0),te(this,"_subs",void 0),te(this,"_log",void 0),te(this,"loadItems",void 0),te(this,"_arrayToDiff",void 0),te(this,"findFirstCardWithContent",void 0),te(this,"notifyAlertsChanged",void 0),te(this,"onSessionStarted",void 0),te(this,"onFirstCheckingFinished",void 0),te(this,"_processEvents",void 0),te(this,"_getAllAlertsIdsFromEvent",void 0),te(this,"_getAlertsIdsFromAlertRef",void 0),te(this,"_getAlertsIdsFromDSL",void 0),te(this,"_resolveAlertIds",void 0),te(this,"_hasAllAlerts",void 0),te(this,"_toInternalDiff",void 0),te(this,"_preserveViewStackForCAPIUpdates",void 0),te(this,"_normalizeSDUIEvents",void 0),te(this,"_toSDUIItem",void 0),te(this,"_emitDomainEvent",void 0),te(this,"_debugLogState",void 0),te(this,"_getBufferObs",void 0),this.alertIdResolver=n,this.popoverManager=r,this._sduiEventsBufferNotifier=i,this._sduiEventsBuffer=A,this._state=c.h.create(E.l.empty),this.state=this._state.view((function(e){return E.l.iso.wrap(e)})),this.globalPartManager=new Z(this.state),this._unresolvedItemsQueueSize=new G.X(0),this.unresolvedItemsQueueSize=this._unresolvedItemsQueueSize.pipe(z.x()),this._onAlertsRefEmpty=new C.xQ,this._removedAlerts=new C.xQ,this._removedRoot=new C.xQ,this._switchView=new C.xQ,this._sessionEvents=new C.xQ,this._reviseSduiQueue=new C.xQ,this._flush=new C.xQ,this._flushViewSwitch=new C.xQ,this._subs=new M.w.Keeper,this._log=b.C8.Logging.getLogger("SDUIManager",S.i.TRACE,S.T.Manager.getColor()),this.loadItems=function(e){var t=(0,a.zG)(e,u.uK((function(e){return"popoverStack"===e.content.type}))),n=t.right,r=t.left;n.forEach((function(e){var t=e.content;"popoverStack"===t.type&&U.popoverManager.addPopover(t)})),(0,a.zG)(r,u.UI((function(e){return re(ne({},e),{invalid:!0})})),U._arrayToDiff,E.l.applyDiff,d.UI(f.T.recover((function(e){return U._log.debug("conflicts on diff apply",e)}))),(function(e){return U._state.modify(e)}))},this._arrayToDiff=function(e){return l.v.fromMutation((function(t){return u.UI((function(e){t.set(e.id,v.F2(e))}))(e)}))},this.findFirstCardWithContent=function(e){return(0,a.zG)(U.state.get(),D.a.get(e),h.UI((function(e){var t=e.content;return L.ab.reduce(t,(function(e,t){return(0,a.zG)(e,p.fold((function(e){return"strongAlertRef"===t.type?p.left(h.G(t)):"assistantCard"===t.type||"inlineCard"===t.type?p.right(J.create(t,e)):p.left(e)}),p.right))}),L.ab.TreeTraversal.PreOrder,p.left(h.YP))})),h.tS(h.Uo))},this.notifyAlertsChanged=function(){return U._reviseSduiQueue.next()},this.onSessionStarted=function(){return U._sessionEvents.next(ue.Start)},this.onFirstCheckingFinished=function(){return U._sessionEvents.next(ue.FirstCheckingFinished)},this._processEvents=function(e){return function(t,n){var r=(0,a.zG)(n,p.fold((function(n){return(0,a.zG)(o.toQueueValuesArray(t),m.hX(e))}),(function(n){if(n.kind===N.e.SduiEventKind.Remove){U._log.debug("[IN - ".concat(n.kind,", {id: ").concat(n.sduiRootId,"}] removeAllBySduiId"));var r=o.Item.fromEvent(n);return o.removeAllBySduiId(r)(t),[r]}var i=o.Item.fromEvent(n);return e(i)?(U._log.debug("[IN - ".concat(i.event.kind," {sduiRootId: ").concat(i.event.sduiRootId,", id: ").concat(i.id," refs: ").concat(JSON.stringify(L.ab.getAlertIds(i.event.sdui)),"}, ] hasAllAlerts")),[i]):(o.addItem(i)(t),U._log.debug("[IN - ".concat(i.event.kind," {sduiRootId: ").concat(i.event.sduiRootId,", id: ").concat(i.id," refs: ").concat(JSON.stringify(L.ab.getAlertIds(i.event.sdui)),"}] add to queue, [queue]: ").concat(o.show.show(t))),[])})),(function(e){return U._log.debug("[completeItems] ".concat(e.map((function(e){return e.id})).join(", "),", [queue]: ").concat(o.show.show(t))),o.removeItems(e)(t),e.forEach((function(e){return o.removeEarlierItemsBySduiId(e)(t)})),e}),m.UI(I.ei("event")));return re(ne({},t),{completeEvents:r})}},this._getAllAlertsIdsFromEvent=function(e,t){return(0,a.ls)((function(e){return e.sdui}),U._getAlertsIdsFromDSL(e,t))},this._getAlertsIdsFromAlertRef=function(e,t){return function(n){return(0,a.zG)(n,L.ab.getAlertIds,g.ew((function(){return t===oe.Silent?{}:U._log.debug("Provided SDUI dsl doesn't contain alertIds array. StrongAlertRef: ".concat(JSON.stringify({id:n.id,type:n.type,name:n.name,alertIds:n.alertIds})))})),h.g_((function(){return[]}),a.yR),U._resolveAlertIds(e,t))}},this._getAlertsIdsFromDSL=function(e,t){return function(n){return(0,a.zG)(n,L.ab.getAllAlertIds,(function(e){return Array.from(new Set(e))}),(function(e){return u.xb(e)?(U._log.trace("Provided SDUI dsl doesn't contain any alertIds references. DSL id: ".concat(n.id)),e):e}),U._resolveAlertIds(e,t))}},this._resolveAlertIds=function(e,t){return function(n){return(0,a.zG)(n,u.UI((function(n){return(0,a.zG)(_.j.AlertId.from(n),e,g.ew((function(){return t===oe.Silent?{}:U._log.error("Alert with raw id ".concat(n,", can not be found. It was either deleted or was not added yet."))})))})),u.vP(h.Kw))}},this._hasAllAlerts=function(e,t){return(0,a.ls)(U._getAllAlertsIdsFromEvent(e,t),h.pC)},this._toInternalDiff=function(e){return function(t){var n=ie(t,2),r=n[0],i=n[1],o=E.l.MutableInternalDiff.empty();return(0,a.zG)(r,s.u4(o,(function(t,n){return n.kind===N.e.SduiEventKind.Remove?U._handleSDUIRemove(n,i,t):(0,a.zG)(U._getAllAlertsIdsFromEvent(e,oe.Silent)(n),h.UI(U._toSDUIItem(n)),h.g_((function(){return U._log.trace(ae.internalDiffParsingError([L.ab.getAllAlertIds(n.sdui).join(", "),n.sduiRootId]))}),(function(e){var r=n.kind;switch(r){case N.e.SduiEventKind.Add:U._handleSDUIAdd(e,n.rev,i,t);break;case N.e.SduiEventKind.Update:U._handleSDUIUpdate(e,i,t);break;default:(0,y.vE)(r)}})),(function(e){return t}))})))}},this._preserveViewStackForCAPIUpdates=function(e){return(0,a.zG)(e,s.UI((function(e){return e.kind!==N.e.SduiEventKind.Update||e.source!==R.i5.CAPI?e:R.R6.of(e.sduiRootId,e.source,e.rev)(h.g_((function(){return h.G(e.sdui)}),(0,a.ls)(L.ab.toContentMap,(function(t){return(0,a.zG)(t,Object.values,m.DZ((function(e){var t=e.content;return"viewStack"===t.type?h.G({type:"switchView",where:t.id,selected:t.selected}):h.YP})),(function(n){return L.ab.bulkSwitchView(e.sdui,n,t)}))}),h.G)))})))},this._normalizeSDUIEvents=function(e){var t=ie(e,2),n=t[0],r=t[1];return(0,a.zG)(n,u.DZ((function(e){return"sdui_lazy_update"!==e.kind?h.G(e):U._handleSDUILazyUpdate(e,r)})))},this._toSDUIItem=function(e){return function(t){return{id:_.j.Item.Id.from(e.sduiRootId),content:e.sdui,alertIds:t}}},this._emitDomainEvent=function(e){U._log.debug("internalDiff",E.l.InternalDiff.show.show(e)),(0,a.zG)(e,E.l.createDiff,f.T.recover((function(e){return U._log.debug("conflicts on diff creating",e)})),(function(e){return U._log.debug("SDUIItemsCollectionDiff",E.l.diffShow.show(e)),e}),E.l.applyDiff,d.UI(f.T.recover((function(e){return U._log.debug("conflicts on diff apply",e)}))),(function(e){return U._state.modify(e)}))},this._debugLogState=function(e){return U._log.debug("[SDUIManagerState] (SDUIItemsCollection)","_latestChangeDiff: ".concat(E.l.diffShow.show(e.latestChangeDiff),",\n _entriesIds: ").concat(E.l.InternalDiff.showMapKeys.show(e.entries),"}"))},this._getBufferObs=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:P.F(100).pipe(k.O(0)),t=F.T(e,U._flush),n=F.T(P.F(100).pipe(k.O(0)),U._flushViewSwitch);return{bufferObsForSDUIEvents:t,bufferObsForViewSwitchEvents:n}},this._subs.push(this.globalPartManager);var O=t.pipe(T.U(R.al.fromSource(R.i5.CAPI))),X=this._getBufferObs(this._sduiEventsBufferNotifier),W=X.bufferObsForSDUIEvents,Y=X.bufferObsForViewSwitchEvents,$=(0,R.yU)(this._removedAlerts.asObservable(),this._removedRoot.asObservable(),this.state,this._switchView.asObservable(),this.popoverManager,this.globalPartManager,this._log,Y),ee=$.emptyAlertsRefReasonTuple,se=$.optimisticRemoveSDUIEvent,ce=$.emptyStrongAlertRefUpdate,de=$.viewStackUpdates,fe=$.activePopoverUpdates,le=$.globalPartPlaceholderUpdates,ve=F.T(O,se,ce).pipe(V.b((function(e){return U._log.debug("Received SDUI event: ".concat(R.al.show.show(e)," from: ").concat(e.source))})),Q.R((function(e,t){var n=t.source;switch(n){case R.i5.RemoveAlertsSDUIAction:case R.i5.RemoveRootSDUIAction:case R.i5.RemoveDuplicate:case R.i5.TextChange:return t.kind===N.e.SduiEventKind.Remove&&e.optRemovedSDUIRootIds.add(t.sduiRootId),re(ne({},e),{event:h.G(t)});case R.i5.CAPI:return(0,a.zG)(t,h.DT((function(t){return e.optRemovedSDUIRootIds.has(t.sduiRootId)})),g.bw((function(t){return e.optRemovedSDUIRootIds.delete(t.sduiRootId)})),h.tS(h.DT((0,w.Kg)(R.G0,R.eQ))),h.g_((function(){return re(ne({},e),{event:h.G(t)})}),(function(t){return t.kind===N.e.SduiEventKind.Remove?re(ne({},e),{event:h.YP}):re(ne({},e),{event:h.G(re(ne({},t),{kind:N.e.SduiEventKind.Add}))})})));case R.i5.SwitchView:return re(ne({},e),{event:h.G(t)});default:(0,y.vE)(n)}}),{optRemovedSDUIRootIds:new Set,event:h.YP}),T.U(I.ei("event")),x.oA,T.U(p.right)),he=(0,a.ls)(I.ei("event"),this._hasAllAlerts(this.alertIdResolver,oe.Silent)),pe=F.T(ve,this._reviseSduiQueue.pipe(T.U(p.left))).pipe(Q.R(this._processEvents(he),re(ne({},o.empty()),{completeEvents:[]})),V.b((function(e){return U._unresolvedItemsQueueSize.next(o.size(e))})),T.U(I.ei("completeEvents"))),me=F.T(pe,de,fe,le).pipe(this._sduiEventsBuffer(W),T.U((function(e){return u.xH(e)})),B.h(u.Od)),Ie=me.pipe(T.U(this._preserveViewStackForCAPIUpdates),K.M(this._state),T.U(this._normalizeSDUIEvents),B.h(u.Od)),ge=this._sessionEvents.pipe(B.h((function(e){return e===ue.Start})),K.M(this._state),T.U((function(e){var t=ie(e,2);t[0];return t[1]})),B.h((function(e){return e.entries.size>0})),T.U(E.l.MutableInternalDiff.fromState((function(e,t){var n=re(ne({},t),{invalid:!0});return _.j.Item.eq.equals(t,n)||e.updated.set(t.id,[t,n]),e})))),ye=this._sessionEvents.pipe(B.h((function(e){return e===ue.FirstCheckingFinished})),K.M(this._state),T.U((function(e){var t=ie(e,2);t[0];return t[1]})),B.h((function(e){return e.entries.size>0})),T.U(E.l.MutableInternalDiff.fromState((function(e,t){var n;return null!==(n=t.invalid)&&void 0!==n&&n&&e.removed.set(t.id,t),e})))),we=F.T(ge,ye);this._subs.push(this._state.pipe(V.b(this._debugLogState)).subscribe(),ee.subscribe((function(e){var t=ie(e,1)[0];return U._onAlertsRefEmpty.next(t)})),Ie.pipe(K.M(this._state),T.U(this._toInternalDiff(this.alertIdResolver)),B.h((0,a.ff)(E.l.InternalDiff.isEmpty)),T.U(this._emitDomainEvent)).subscribe(),we.subscribe(this._emitDomainEvent))}var t,n,r;return t=e,(n=[{key:"onAlertsRefEmpty",get:function(){return this._onAlertsRefEmpty.asObservable()}},{key:"pushRemovedRoot",value:function(e){this._removedRoot.next(e)}},{key:"pushRemovedAlerts",value:function(e){this._removedAlerts.next(e)}},{key:"pushSwitchView",value:function(e){this._switchView.next(e)}},{key:"flush",value:function(){this._flush.next(),this._flushViewSwitch.next(),this._flush.next()}},{key:"resolveStrongAlertRefAlerts",value:function(e){var t=this;return(0,a.zG)(this._getAlertsIdsFromAlertRef(this.alertIdResolver,oe.Error)(e),g.ew((function(){return t._log.debug("Alert ids from the provided component were not removed, because AlertIds for the provided DSL was not resolved. SDUI content ".concat(JSON.stringify({id:e.id,type:e.type,name:e.name,alertIds:e.alertIds})))})))}},{key:"_handleSDUIAdd",value:function(e,t,n,r){var i=this;return"popoverStack"===e.content.type?(this.popoverManager.addPopover(e.content,t),E.l.MutableInternalDiff.empty()):((0,a.zG)(n,E.l.get(e.id),h.g_((function(){if((0,y.kG)(!r.updated.has(e.id),"SDUI item can not be in the diff.updated until it gets to the collection",(function(){return E.l.InternalDiff.show.show(r)+E.l.diffShow.show(E.l.diff(E.l.empty,n))})),r.removed.has(e.id))return i._log.trace(ae.actionOnRemovedItem([e.id,"added"]));r.added.set(e.id,e)}),(function(t){if((0,y.kG)(!r.added.has(e.id),"SDUI item can not be in the diff.added when it is already in the collection",(function(){return E.l.InternalDiff.show.show(r)+E.l.diffShow.show(E.l.diff(E.l.empty,n))})),r.removed.has(e.id))return i._log.trace(ae.actionOnRemovedItem([e.id,"added"]));r.updated.set(e.id,[t,e])}))),r)}},{key:"_handleSDUIUpdate",value:function(e,t,n){var r=this;return(0,a.zG)(t,E.l.get(e.id),h.g_((function(){return(0,y.kG)(!n.updated.has(e.id),"SDUI item can not be in the diff.updated until it gets to the collection"+E.l.InternalDiff.show.show(n)+E.l.diffShow.show(E.l.diff(E.l.empty,t))),n.removed.has(e.id)?r._log.trace(ae.actionOnRemovedItem([e.id,"updated"])):n.added.has(e.id)?(r._log.trace(ae.updateIdMissingFound([e.id])),void n.added.set(e.id,e)):r._log.error(ae.updateIdMissingNotFound([e.id]))}),(function(i){return(0,y.kG)(!n.added.has(e.id),"SDUI item can not be in the diff.added when it is already in the collection"+E.l.InternalDiff.show.show(n)+E.l.diffShow.show(E.l.diff(E.l.empty,t))),n.removed.has(e.id)?r._log.trace(ae.actionOnRemovedItem([e.id,"update"])):_.j.Item.eq.equals(i,e)?r._log.trace(ae.updateItemsAreEqual([e.id])):void n.updated.set(e.id,[i,e])}))),n}},{key:"_handleSDUIRemove",value:function(e,t,n){var r=this,i=_.j.Item.Id.from(e.sduiRootId);return this.popoverManager.removePopover(i,e.rev),(0,a.zG)(t,E.l.get(i),h.g_((function(){if((0,y.kG)(!n.updated.has(i),"SDUI item can not be in the diff.updated until it gets to the collection"+E.l.InternalDiff.show.show(n)+E.l.diffShow.show(E.l.diff(E.l.empty,t))),!n.added.has(i))return r._log.trace(ae.removeIdMissingNotFound([i]));r._log.trace(ae.removeIdMissingFound([i])),n.added.delete(i)}),(function(e){(0,y.kG)(!n.added.has(e.id),"SDUI item can not be in the diff.added when it is already in the collection"+E.l.InternalDiff.show.show(n)+E.l.diffShow.show(E.l.diff(E.l.empty,t))),n.updated.delete(i)?r._log.trace(ae.idRemovedFrom([i,"diff.updated"])):(0,a.Q1)(),n.removed.set(i,e)}))),n}},{key:"_handleSDUILazyUpdate",value:function(e,t){var n=this;return(0,a.zG)(t,E.l.get(e.sduiRootId),g.ew((function(){return n._log.trace("SDUI Item with sduiRootId ".concat(e.sduiRootId,"  was not found"))})),h.g_((function(){return e.toContent(h.YP)}),(function(t){var r=t.content;return(0,a.zG)(e.toContent(h.G(r)),h.hX((function(e){return!L.ab.eq.equals(e,r)})),g.ew((function(){return n._log.trace("SDUI Update event ".concat(JSON.stringify(e)," will be skipped, because the new DSL is the same as an old one"))})))})),h.UI((function(t){return{kind:N.e.SduiEventKind.Update,sdui:t,sduiRootId:N.e.RawSduiItem.Id.create(e.sduiRootId),rev:e.rev,source:e.source}})))}},{key:"dispose",value:function(){this._subs.dispose()}}])&&ee(t.prototype,n),r&&ee(t,r),e}(),ae={removeIdMissingFound:function(e){var t=ie(e,1)[0];return"[Remove] SDUI item with ID ".concat(t," was found in the added messages. Removing it.")},removeIdMissingNotFound:function(e){var t=ie(e,1)[0];return"[Remove] It is not possible to remove SDUI item with ID ".concat(t,". It is missing from SDUIItemsCollectionInternal and diff.add, probably it was deleted earlier. Skipping the message")},idRemovedFrom:function(e){var t=ie(e,2),n=t[0],r=t[1];return"[Remove] SDUI item with ID ".concat(n," is going to be removed. ").concat(r," contains the item with ID ").concat(n," too. Remove ").concat(n," from ").concat(r)},actionOnRemovedItem:function(e){var t=ie(e,2),n=t[0],r=t[1];return"[".concat(r,"] It is not possible to ").concat(r," SDUI item with ID ").concat(n,". Because it was already removed. Skipping the ").concat(r,".")},viewStackUpdateIdMissing:function(e){var t=ie(e,1)[0];return"[ViewStackUpdate] SDUI item with ID ".concat(t," was found. Skipping the update.")},updateIdMissingFound:function(e){var t=ie(e,1)[0];return"[Update] SDUI item with ID ".concat(t," was found in added messages. Updating it in added messages")},updateIdMissingNotFound:function(e){var t=ie(e,1)[0];return"[Update] It is not possible to update SDUI item with ID ".concat(t,". It is missing from SDUIItemsCollectionInternal and diff.added, probably it was deleted earlier. Skipping the message")},updateItemsAreEqual:function(e){var t=ie(e,1)[0];return"[Update] Received sdui item (sduiId: ".concat(t,") is the same as in the state. Skipping the update message")},internalDiffMissingAlertsIds:function(){return"missing AlertIDs"},internalDiffParsingError:function(e){var t=ie(e,2),n=t[0],r=t[1];return"toInternalDiff, either can not resolve ".concat(n," for ").concat(r," or id of the sdui item is missing . The item will be skipped")}};!function(e){e.Silent="Silent",e.Error="Error"}(oe||(oe={})),function(e){e.Start="Start",e.FirstCheckingFinished="FirstCheckingFinished"}(ue||(ue={}))},18009:(e,t,n)=>{n.d(t,{al:()=>L,R6:()=>X,i5:()=>q,yU:()=>K,eQ:()=>Y,G0:()=>W});var r,i,o,u,s,a,c=n(14537),d=n(55289),f=n(35728),l=n(13058),v=n(20401),h=n(25394),p=n(50683),m=n(68910),I=n(5314),g=n(89959),y=n(98361),w=n(24121),b=n(44127),S=n(13650),_=n(37662),R=n(96996),A=n(33721),U=n(75449),O=n(93361),D=n(74719),E=n(78271),P=n(45508),k=n(57312),j=n(70775);function G(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function z(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function C(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function M(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function F(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o=[],u=!0,s=!1;try{for(n=n.call(e);!(u=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);u=!0);}catch(e){s=!0,i=e}finally{try{u||null==n.return||n.return()}finally{if(s)throw i}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return G(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return G(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function V(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Q(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function x(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o=[],u=!0,s=!1;try{for(n=n.call(e);!(u=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);u=!0);}catch(e){s=!0,i=e}finally{try{u||null==n.return||n.return()}finally{if(s)throw i}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return T(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return T(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}u=r||(r={}),(o=u.EmptyMessage||(u.EmptyMessage={})).fromItem=function(e){return e.alertIds,M(e,["alertIds"])},o.show={show:function(e){var t=e.sduiId,n=e.sduiRootId;return JSON.stringify({sduiId:t,sduiRootId:n})}},(u.EmptyItem||(u.EmptyItem={})).isRootItem=function(e){return e.sduiId===e.sduiRootId},function(e){e.fromSDUI=function(e){return function(r){return O.ab.reduce(r.content,(function(i,o){return(0,l.zG)(i,h.tS((function(t){return(0,l.zG)(o,O.ab.getAlertIds,h.tS(e),h.UI(n(t)),h.wp((function(){return i})))})),h.wp((function(){return(0,l.zG)(o,O.ab.getAlertRefs,h.tS(t(r.id,e)))})))}),O.ab.TreeTraversal.PreOrder,h.YP)}};var t=function(e,t){return function(r){return r.reduce((function(r,i){return(0,l.zG)(r,h.UI((function(e){return(0,l.zG)(i.alertIds,t,h.g_((function(){return e}),n(e)))})),h.wp((function(){return h.G({emptyStrongAlertRef:i,sduiId:e,sduiRootId:e,alertIds:new Set((0,l.zG)(i.alertIds,t,h.fS((0,l.a9)(v.cS))))})})))}),h.YP)}},n=(e.fromStrongAlertRef=function(e){return function(t,n){return(0,l.zG)(e(t.alertIds),h.UI((function(e){return{sduiRootId:n,sduiId:D.j.Item.Id.from(t.id),emptyStrongAlertRef:t,alertIds:new Set(e)}})))}},e.fromStrongAlertRefBehavior=function(e){return function(t,n,r){return(0,l.zG)(e(t.alertIds),h.UI((function(e){return{sduiRootId:r,sduiId:n,emptyStrongAlertRef:t,alertIds:new Set(e)}})))}},e.show={show:function(e){return"StrAlertRef.Item: { sduiId: ".concat(e.sduiId,", sduiRootId: ").concat(e.sduiRootId,", alertIds: [").concat(Array.from(e.alertIds.values()).join(", "),"]}")}},e.addAlertIds=function(e){return function(t){return t.forEach((function(t){return e.alertIds.add(t)})),e}})}(s=u.Item||(u.Item={})),function(e){e.iso=P.k4(),e.empty=function(){return{alertRefMapping:new Map}},e.size=function(e){return e.alertRefMapping.size},e.show={show:function(e){return Array.from(e.alertRefMapping.entries()).map((function(e){var t=F(e,2),n=t[0],r=t[1];return"".concat(n,": [\n").concat(r.map(s.show.show).join("\n"),"\n]")})).join("\n")}};var t=function(e){return function(t){return(0,l.zG)(t.alertRefMapping.get(e),h.ij)}},n=(e.get=function(e){return function(n){return(0,l.zG)(t(e)(n),h.UI(v.UI((function(e){return C(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){z(e,t,n[t])}))}return e}({},e),{alertIds:new Set(e.alertIds)})}))))}},e.updateWithRemovedAlerts=function(e){return function(n){return(0,l.zG)(e,d.tS((function(e){return(0,l.zG)(n,t(e),h.UI(v.hX((function(t){return t.alertIds.delete(e)&&0===t.alertIds.size}))),h.g_((function(){return[]}),(function(t){return n.alertRefMapping.delete(e),t.map(r.EmptyMessage.fromItem)})))})))}},e.add=function(e,t){return function(r){j.uZ.isStrongAlertRefBehavior(e.emptyStrongAlertRef)?(0,l.zG)(s.fromStrongAlertRefBehavior(t)(e.emptyStrongAlertRef,e.sduiId,e.sduiRootId),k.bw(n(r))):O.ab.forEach(e.emptyStrongAlertRef,(0,l.ls)(function(e,t){return function(n){return(0,l.zG)(n,O.ab.getAlertRefs,h.g_((0,l.a9)(d.cS),d.DZ((function(r){return j.uZ.isStrongAlertRefBehavior(r)?s.fromStrongAlertRefBehavior(t)(r,D.j.Item.Id.from(n.id),e):s.fromStrongAlertRef(t)(r,e)}))))}}(e.sduiRootId,t),v.UI(n(r))),O.ab.TreeTraversal.PostOrder)}},function(e){var t=i(e);return function(e){e.alertIds.forEach((function(n){return t(n,[e])}))}}),i=function(e){return function(t,n){var r=e.alertRefMapping.get(t);e.alertRefMapping.set(t,null!=r?r.concat(n):n)}};e.remove=function(e){return function(n){return(0,l.zG)(Array.from(e.alertIds.keys()),v.u4(new Array,(function(r,o){return(0,l.zG)(n,t(o),h.UI(v.hX((function(t){return t.sduiRootId!==e.sduiRootId}))),h.g_((function(){r.push("failed to remove SDUI by alertId ".concat(o,", alertRefMapping doesn't contain alertId ").concat(o))}),(function(e){return function(e){return function(t,n){0===n.length?e.alertRefMapping.delete(t):i(e)(t,n)}}(n)(o,e)}))),r})))}}}(a||(a={})),(i=u.Collection||(u.Collection={})).empty=function(){return a.iso.wrap(a.empty())},i.size=function(e){return(0,l.zG)(a.iso.unwrap(e),a.size)},i.show={show:function(e){return(0,l.zG)(a.iso.unwrap(e),a.show.show)}},i.get=function(e){return function(t){return(0,l.zG)(a.iso.unwrap(t),a.get(e))}},i.add=function(e,t){return function(n){return(0,l.zG)(a.iso.unwrap(n),a.add(e,t))}},i.remove=function(e){return function(t){return(0,l.zG)(a.iso.unwrap(e),a.remove(t))}},i.updateWithRemovedAlerts=function(e){return function(t){return(0,l.zG)(a.iso.unwrap(t),a.updateWithRemovedAlerts(e))}};var B=(0,l.ls)(v.UI(D.j.AlertId.from),h.G),K=function(e,t,n,i,o,u,s,a){var P=e.pipe(p.M(n),m.b((function(e){var t=x(e,1),n=x(t[0],2),r=n[0],i=n[1];s.trace("[Optimistic update] emptyAlertsRefReasonTuple > Removed alerts. Reason: ".concat(i,", removedAlertIds: [").concat(r.join(", "),"]"))})),I.U((function(e){var t=x(e,2),n=x(t[0],2),i=n[0],o=n[1],u=t[1];return[(0,l.zG)(u,N(s),r.Collection.updateWithRemovedAlerts(i)),o]})),m.b((function(e){var t=x(e,2),n=t[0],i=t[1];return s.trace("[Optimistic update] emptyAlertsRefReasonTuple > Reason: ".concat(i," found emptyAlertsRef: [").concat(n.map(r.EmptyMessage.show.show).join(", "),"]"))})),g.w((function(e){var t=x(e,2),n=t[0],r=t[1];return(0,l.zG)(n,d.UI((function(e){return[e,r]})),(function(e){return y.D(e)}))})),w.B()),k=P.pipe(b.h((function(e){var t=x(e,1)[0];return r.EmptyItem.isRootItem(t)})),I.U((function(e){var t=x(e,2),n=t[0],r=t[1];return L.toRemovedEvent(r)(U.e.RawSduiItem.Id.create(n.sduiRootId))}))),j=t.pipe(I.U((function(e){var t=x(e,2),n=t[0],r=t[1];return L.toRemovedEvent(r)(U.e.RawSduiItem.Id.create(n))}))),G=S.T(k,j),z=P.pipe(b.h((function(e){var t=x(e,1)[0];return!r.EmptyItem.isRootItem(t)})),p.M(n),I.U((function(e){var t=x(e,2),n=x(t[0],2),r=n[0],i=n[1],o=t[1],u=U.e.RawSduiItem.Id.create(r.sduiRootId);return(0,l.zG)(E.a.get(D.j.Item.Id.from(r.sduiRootId))(o),h.tS((function(e){return O.ab.removeStrongAlertRef(e.content)([r.emptyStrongAlertRef])})),h.g_((function(){return L.toRemovedEvent(i)(U.e.RawSduiItem.Id.create(r.sduiRootId))}),(function(e){return L.toUpdatedEvent(i)(e,u)})))})));return{emptyAlertsRefReasonTuple:P,optimisticRemoveSDUIEvent:G,emptyStrongAlertRefUpdate:z,viewStackUpdates:i.pipe(_.f(a),b.h(v.Od),I.U((0,l.ls)(c.vM((function(e){return e.sduiRootId})),f.AO,d.UI((function(e){var t=x(e,2),n=t[0],r=t[1];return r.forEach((function(e){return o.switchView(e)})),X.of(n,"switchView")(h.tS((function(e){return(0,l.zG)(O.ab.bulkSwitchView(e,r.map((function(e){return{where:e.where,selected:e.selected,type:"switchView"}}))),h.G)})))}))))),activePopoverUpdates:R.aj([o.activePopoverView.pipe(A.n(h.Wi)),n.pipe(I.U(E.a.sduiRoots()))]).pipe(I.U((function(e){var t=x(e,2),n=t[0];return t[1].map((function(e){return X.of(e,"switchView")(h.tS((function(e){return O.ab.setPopoverView(e,n)})))}))}))),globalPartPlaceholderUpdates:u.globalPartsAvailable.pipe(b.h(l.yR),g.w((function(){return n})),I.U(E.a.sduiRoots()),I.U((function(e){return e.map((function(e){return X.of(e,"capi")(h.tS((function(e){return O.ab.setGlobalPartPlaceholderContent(e,u.getGlobalPartById)})))}))})))}};function N(e){return E.a.reduce(r.Collection.empty(),(function(t,n){return(0,l.zG)(r.Item.fromSDUI(B)(n),h.g_((function(){return e.trace("SDUI item ".concat(D.j.Item.show.show(n)," does not contain AlertRef, skipping it"))}),(function(e){return r.Collection.add(e,B)(t)})),(function(e){return t}))}))}var L,q,X,W=function(e){return e.kind==U.e.SduiEventKind.Update},Y=function(e){return e.kind==U.e.SduiEventKind.Remove};!function(e){e.fromSource=function(e){return function(t){return Q(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){V(e,t,n[t])}))}return e}({},t),{source:e})}},e.toRemovedEvent=function(e){return function(t){return{kind:U.e.SduiEventKind.Remove,sduiRootId:t,source:e,rev:0}}},e.toUpdatedEvent=function(e){return function(t,n){return{kind:U.e.SduiEventKind.Update,sdui:t,sduiRootId:n,source:e,rev:0}}},e.show={show:function(e){return"SduiRootId: ".concat(e.sduiRootId,", Kind: ").concat(e.kind,", Source: ").concat(e.source)}}}(L||(L={})),function(e){e.CAPI="capi",e.TextChange="textChange",e.RemoveAlertsSDUIAction="removeAlerts",e.RemoveRootSDUIAction="removeRoot",e.RemoveDuplicate="removeDuplicate",e.SwitchView="switchView"}(q||(q={})),function(e){e.of=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return function(r){return{kind:"sdui_lazy_update",toContent:r,sduiRootId:D.j.Item.Id.from(e),rev:n,source:t}}}}(X||(X={}))},56014:(e,t,n)=>{n.d(t,{J:()=>f});var r=n(96031),i=n(25394),o=n(32559),u=n(11224),s=n(13058),a=n(93361);function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var f=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),d(this,"activePopoverStack",void 0),d(this,"activePopoverView",void 0),d(this,"_state",void 0),this._state=r.h.create({dsl:i.YP,revision:-1}),this.activePopoverStack=this._state.view("dsl"),this.activePopoverView=this.activePopoverStack.view(i.tS((function(e){return i.ij(e.views[e.selected])})))}var t,n,f;return t=e,(n=[{key:"getInteractionActions",value:function(e,t,n){return(0,s.zG)(this._state.get(),(function(e){return e.dsl}),i.hX((function(n){return n.id===e&&n.selected===t})),i.UI((function(e){return e.views[e.selected]})),i.g_((function(){return[]}),(function(e){switch(n){case u.fP.Fulfill:return e.onFulfill||[];case u.fP.Dismiss:return e.onDismiss||[];default:(0,o.L0)(n)}})))}},{key:"addPopover",value:function(e,t){this._state.modify((function(n){var r=void 0!==t&&n.revision>t,o=void 0!==t&&n.revision===t,u=(0,s.zG)(n.dsl,i.Gg((function(t){return t.id===e.id}))),a=!i.Wi(n.dsl);return r||u||o&&a?n:{dsl:i.G(e),revision:null!=t?t:n.revision}}))}},{key:"removePopover",value:function(e,t){this._state.modify((function(n){var r=void 0!==t&&n.revision>t,o=(0,s.zG)(n.dsl,i.Gg((function(t){return t.id===e})));return r||!o?n:{dsl:i.YP,revision:null!=t?t:n.revision}}))}},{key:"switchView",value:function(e){this._state.modify((function(t){return(0,s.zG)(t.dsl,i.hX((function(t){return t.id===e.sduiRootId})),i.UI((function(t){return a.ab.bulkSwitchView(t,[{where:e.where,selected:e.selected,type:"switchView"}])})),i.hX((function(e){return"popoverStack"===e.type})),i.g_((function(){return t}),(function(e){return{dsl:i.G(e),revision:t.revision}})))}))}}])&&c(t.prototype,n),f&&c(t,f),e}()},75449:(e,t,n)=>{var r;n.d(t,{e:()=>r}),function(e){var t;!function(e){!function(e){e.create=function(e){return e.toString()}}(e.Id||(e.Id={}))}(e.RawSduiItem||(e.RawSduiItem={})),function(e){e.Add="sdui_add",e.Remove="sdui_remove",e.Update="sdui_update"}(t=e.SduiEventKind||(e.SduiEventKind={})),e.isSduiEvent=function(e){return e.kind===t.Add||e.kind===t.Remove||e.kind===t.Update}}(r||(r={}))}}]);