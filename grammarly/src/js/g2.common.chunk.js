(self.webpackChunk=self.webpackChunk||[]).push([[274],{93265:(e,t,i)=>{var a=i(64533),r="chrome-extension://__MSG_@@extension_id__/",n="moz-extension://__MSG_@@extension_id__/",s="safari-web-extension://__MSG_@@extension_id__/",l=self.GR_RESOURCE_ROOT||r,o=self.GR_RESOURCE_ROOT||n,d=self.GR_RESOURCE_ROOT||s;e.exports={__css:a.toString().replace(new RegExp(r,"g"),l).replace(new RegExp(n,"g"),o).replace(new RegExp(s,"g"),d),...a.locals}},66265:(e,t,i)=>{i.r(t),i.d(t,{G2FeatureImpl:()=>lt});var a=i(68665),r=i(10980),n=i(5621),s=i(96031),l=i(67167),o=i(77141);const d=a.lazy((()=>Promise.all([i.e(4057),i.e(4169),i.e(5924),i.e(274)]).then(i.bind(i,1284)).then((({ParagraphHighlightCollection:e})=>({default:e}))))),c=a.lazy((()=>Promise.all([i.e(4057),i.e(4169),i.e(5924),i.e(274)]).then(i.bind(i,69164)).then((({SidelineCollection:e})=>({default:e})))));var h=i(78615),m=i(96996),g=i(5314),u=i(74525),p=i(44127),f=i(13650),b=i(82562),w=i(68910),S=i(89959),v=i(13659),y=i(6835),_=i(21315),C=i(77298),x=i(34124),k=i(13058),R=i(25394),E=i(95907);var F=i(58376),I=i(59137);function T(e){return e.trim().split(/\s+/).filter((e=>""!==e)).length}function P(e,t){return e.map((e=>function(e,t){return(0,k.zG)(e.transformJSON.alternatives,R.UI((({alternatives:e,context:t})=>({alternative:e[0],context:t[0]}))),R.UI((({alternative:e,context:t})=>({ops:e.ops,context:t}))),R.UI((({ops:i,context:a})=>{let r=a.s,n=0;for(const e of i)F.s.isRetain(e)&&e.type===I.JU.TypeExt.OptionalContext||F.s.match((e=>{F.s.isInsertString(e)&&(n+=T(e.insert),r+=e.insert.length)}),(e=>{const i=r+e.delete;n+=T(t.slice(r,i)),r=i}),(e=>{r+=e.retain}))(e);return n*((s=e.patternName).includes("MissingSpace")||s.includes("RedundantSpace")||s.includes("Clarity")||s.includes("Punctuation")?.5:s.includes("Formatting")||s.includes("Passive")||s.includes("Dialects")?.25:s.includes("Calliope")?.75:s.includes("Tone")||s.includes("Engagement")?.1:s.includes("RunOn")?2:s.includes("Style")?.5:s.includes("Fluency")||s.includes("FluencyRewrite")?.25:1);var s})),R.fS((()=>0)))}(e,t))).reduce(((e,t)=>e+t),0)}function G(e,t,i){if(e.text.length<50)return R.YP;const a=function(e,t){return e.filter((e=>e.transformJSON.highlights.some((e=>e.e>t.start&&e.s<t.end))))}(t,e.textRange);if(a.some((e=>e.patternName.startsWith("WritingExpert"))))return R.G("writingCoach");const r=P(a.filter((e=>!e.patternName.startsWith("WritingExpert"))),i),n=(s=e.text,Math.max(5,Math.min(10,T(s)/10)));var s;return Math.round(r)>=n?R.G("attention"):R.YP}function M(e){return(0,k.zG)(e,R.g_((()=>"idle"),(e=>"attention"===e||"writingCoach"===e?"attention":"selection"===e?"selection":"idle")))}var B=i(50238),L=i(40568),O=i(16731);var N=i(50301),A=i(41040);class z{constructor(e){this._params=e,this._subs=new r.w,this._logger=o.Y.create("SidelineCollectionViewModelImpl"),this._referenceElementBySidelineSequentialId=new Map,this._paragraphSidelines=s.h.create([]),this._paragraphSidelineBySequentialId=new Map,this._pinnedSidelineSequentialId=s.h.create(R.YP),this._pinnedSideline=s.h.combine(this._pinnedSidelineSequentialId,this._paragraphSidelines,(e=>(0,k.zG)(e,R.tS((e=>e===B.ZR?this._selectionSideline.get():R.ij(this._paragraphSidelineBySequentialId.get(e))))))),this._activeSidelineSequentialId=s.h.create(R.YP),this._activeSideline=s.h.combine(this._pinnedSideline,this._activeSidelineSequentialId,this._paragraphSidelines,((e,t)=>(0,k.zG)(e,R.wp((()=>(0,k.zG)(t,R.tS((e=>e===B.ZR?this._selectionSideline.get():R.ij(this._paragraphSidelineBySequentialId.get(e)))))))))),this._emphasizedSidelineSequentialId=s.h.create(R.YP),this._emphasizedSideline=s.h.combine(this._pinnedSideline,this._activeSideline,this._emphasizedSidelineSequentialId,this._paragraphSidelines,((e,t,i)=>(0,k.zG)(e,R.wp((()=>(0,k.zG)(t,R.wp((()=>(0,k.zG)(i,R.tS((e=>e===B.ZR?this._selectionSideline.get():R.ij(this._paragraphSidelineBySequentialId.get(e))))))))))))),this._selectionSideline=s.h.create(R.YP),this._shouldHideSidelinesDueToScrolling=s.h.create(!1),this._shouldHideSidelines=s.h.create(!1),this._sidelineCardActiveNotifications=new h.xQ,this._dynamicConfigDecoded=(0,N.C9)(this._params.integrationName,(0,A.u)(this._params.integrationName,this._params.user)),this._deactivateSidelineSubs=new r.w,this.paragraphSidelines=this._paragraphSidelines.view(),this.pinnedSideline=this._pinnedSideline.view(),this.activeSideline=this._activeSideline.view(),this.emphasizedSideline=this._emphasizedSideline.view(),this.selectionSideline=this._selectionSideline.view(),this.shouldHideSidelines=this._shouldHideSidelines.view(),this._subs.add(m.aj([this._params.paragraphHighlightCollectionViewModel.paragraphHighlights,this._params.alerts]).pipe(g.U((([e,t])=>e.map((e=>(this._dynamicConfigDecoded.showAttentionSidelines||this._dynamicConfigDecoded.showIdleSidelines)&&e.isScrolledIntoView?(0,k.zG)(this._params.paragraphCollectionService.getParagraphById(e.paragraphId),R.g_((()=>(this._params.telemetry.warn({message:"Creating sideline failed."}),this._logger.warn("Failed to create paragraph sideline; skipping.",{paragraphId:e.paragraphId}),R.YP)),(i=>function(e,t,i,a,r,n){const s=`g2-paragraph-sideline-${e.textRange.start}-${e.textRange.end}`,l=G(e,i,a),o={kind:"paragraphSideline",id:s,sequentialId:e.sequentialId,paragraphId:e.id,paragraphHighlightViewportRect:{top:t.viewportRect.top,left:t.viewportRect.left,width:t.viewportRect.width,height:t.viewportRect.height},signal:l};return(0,k.zG)(l,R.g_((()=>n?R.G(o):R.YP),(e=>{const t=M(R.G(e)),i=n&&!r;switch(t){case"idle":return n?R.G(o):R.YP;case"attention":return r?R.G(o):i?R.G({...o,signal:R.YP}):R.YP;default:return R.YP}})))}(i,e,t,this._params.textObserver.getCurrentTextMap().getPlainText(),this._dynamicConfigDecoded.showAttentionSidelines,this._dynamicConfigDecoded.showIdleSidelines))),R.WG):null)).filter(E.Nf)))).subscribe(u.wW(this._paragraphSidelines))),this._subs.add(this._paragraphSidelines.subscribe((e=>{this._paragraphSidelineBySequentialId.clear();for(const t of e)this._paragraphSidelineBySequentialId.set(t.sequentialId,t)}))),this._subs.add(this._params.paragraphHighlightCollectionViewModel.emphasizedParagraphHighlight.pipe(g.U(R.UI((e=>e.sequentialId)))).subscribe(u.wW(this._emphasizedSidelineSequentialId))),this._dynamicConfigDecoded.showSelectionSidelines&&this._subs.add(m.aj([this._params.selectionHighlightViewModel.selectionHighlight,this._activeSideline]).pipe(p.h((([e,t])=>(0,k.zG)(O.Yt(R.Kw)({selectionSideline:this._selectionSideline.get(),activeSideline:t}),R.g_(k.W8,(({selectionSideline:e,activeSideline:t})=>e.id!==t.id))))),g.U((([e])=>(0,k.zG)(e,R.hX((e=>e.isScrolledIntoView)),R.UI((e=>function(e){return{kind:"selectionSideline",id:`g2-selection-sideline-${e.textRange.start}-${e.textRange.end}`,sequentialId:B.ZR,text:e.text,textRange:e.textRange,selectionHighlightViewportRect:{top:e.viewportRect.top,left:e.viewportRect.left,width:e.viewportRect.width,height:e.viewportRect.height}}}(e))))))).subscribe(u.wW(this._selectionSideline))),this._subs.add(f.T(this._params.textFieldLayout.scroll.changes,b.R((0,L.Jj)(this._params.textFieldElement),"scroll",{capture:!0})).pipe(w.b((()=>this._shouldHideSidelinesDueToScrolling.set(!0))),S.w((()=>v.timer(1e3).pipe(w.b((()=>this._shouldHideSidelinesDueToScrolling.set(!1))))))).subscribe()),this._subs.add(m.aj([this._params.legacyAssistantOpenState,this._params.assistantState,this._shouldHideSidelinesDueToScrolling]).pipe(g.U((([e,t,i])=>"open"===e||"opened"===t.kind||i))).subscribe(u.wW(this._shouldHideSidelines))),this._subs.add(this._shouldHideSidelines.pipe(p.h(Boolean)).subscribe((()=>{this._pinnedSidelineSequentialId.set(R.YP),this._activeSidelineSequentialId.set(R.YP)}))),this._subs.add(this._paragraphSidelines.pipe(g.U((e=>e.filter((e=>R.pC(e.signal))))),n.x(((e,t)=>{if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(e[i].id!==t[i].id)return!1;return!0})),w.b((()=>{this._logger.debug("Paragraph sidelines with signals updated."),this._params.gnar.vBarsLoaded()}))).subscribe()),this._subs.add(this._paragraphSidelines.subscribe((e=>this._logger.debug("Paragraph sidelines updated.",e)))),this._subs.add(this._pinnedSideline.subscribe((e=>this._logger.debug("Pinned sideline updated.",R.WG(e))))),this._subs.add(this._activeSideline.subscribe((e=>this._logger.debug("Active sideline updated.",R.WG(e))))),this._subs.add(this._emphasizedSideline.subscribe((e=>this._logger.debug("Emphasized sideline updated.",R.WG(e))))),this._subs.add(this._selectionSideline.subscribe((e=>this._logger.debug("Selection sideline updated.",R.WG(e)))))}_doesSequentialIdMatchRelevantSidelineSequentialId(e,t){return(0,k.zG)(t,R.g_(k.jv,(t=>t===e)))}_getSidelineBySequentialId(e){return e===B.ZR?this._selectionSideline.get():R.ij(this._paragraphSidelineBySequentialId.get(e))}_deactivateSideline(e,t=!1){this._logger.debug("Deactivating sideline.",{sidelineSequentialId:e,immediate:t}),this._doesSequentialIdMatchRelevantSidelineSequentialId(e,this._activeSidelineSequentialId.get())?this._deactivateSidelineSubs=this._sidelineCardActiveNotifications.pipe(p.h((t=>t===e)),y.q(1),_.h(!1),C.L(t?0:100,x.of(!0))).subscribe((t=>{t?(this._logger.debug("Did not receive notification that corresponding sideline card is active, proceeding to deactivate sideline.",{sidelineSequentialId:e}),this._activeSidelineSequentialId.set(R.YP)):this._logger.debug("Received a notification that corresponding sideline card is active, won't deactivate sideline.",{sidelineSequentialId:e})})):(this._params.telemetry.warn({message:"Deactivation of an inactive sideline attempted."}),this._logger.warn("Tried to deactivate sideline that is not active, this is a no-op.",{sidelineSequentialId:e}))}_unpinSideline(e){this._logger.debug("Unpinning sideline.",{sidelineSequentialId:e}),this._doesSequentialIdMatchRelevantSidelineSequentialId(e,this._pinnedSidelineSequentialId.get())?(this._pinnedSidelineSequentialId.set(R.YP),this._activeSidelineSequentialId.set(R.YP)):(this._params.telemetry.warn({message:"Unpinning of an unpinned sideline attempted."}),this._logger.warn("Tried to unpin sideline that is not pinned, this is a no-op.",{sidelineSequentialId:e}))}activateSideline(e){this._logger.debug("Activating sideline.",{sidelineSequentialId:e}),this._activeSidelineSequentialId.set(R.G(e)),this._deactivateSidelineSubs.unsubscribe()}deactivateSideline(e){this._deactivateSideline(e)}pinSideline(e){this._logger.debug("Pinning sideline.",{sidelineSequentialId:e}),this._pinnedSidelineSequentialId.set(R.G(e))}unpinSideline(e){this._unpinSideline(e)}setSidelineReferenceElement(e,t){this._referenceElementBySidelineSequentialId.set(e,t)}getSidelineReferenceElement(e){return R.ij(this._referenceElementBySidelineSequentialId.get(e))}notifySidelineCardActive(e,t){this._sidelineCardActiveNotifications.next(e),t&&this.pinSideline(e)}notifySidelineCardInactive(e,t){R.pC(this._pinnedSideline.get())?this._unpinSideline(e):R.pC(this._activeSideline.get())&&this._deactivateSideline(e,t)}getSideline(e){return this._getSidelineBySequentialId(e)}getSidelineTextInfo(e){return(0,k.zG)(this._getSidelineBySequentialId(e),R.tS((e=>(0,B.iu)(e)?R.G({text:e.text,textRange:e.textRange}):(0,k.zG)(this._params.paragraphCollectionService.getParagraphById(e.paragraphId),R.UI((e=>({text:e.text,textRange:e.textRange})))))))}dispose(){this._deactivateSidelineSubs.unsubscribe(),this._subs.unsubscribe()}}var D=i(73602),q=i(45327),H=i(27296),V=i(65585),U=i(58212),W=i(8649),Y=i(12201),j=i(75410);const $=({paragraph:e,fullText:t})=>{let i=e.textRange.start,a=!1;for(;i>=0&&!a;){if(t.charAt(i)===j.Mx)return!1;t.charAt(i)===j.$O?a=!0:i--}i=e.textRange.end;let r=!1;for(;i<=t.length&&!r;){if(t.charAt(i)===j.$O)return!1;t.charAt(i)===j.Mx?r=!0:i++}return a&&r};var J=i(44501),K=i(36255),Q=i(29101);function X(e,t){return e.pipe(q.O(null),g.U((()=>(0,k.zG)(t.getCurrentSelection(!0),Q.Ls,R.ij,R.hX((0,k.ff)(K.SV.isCollapsed))))),v.skipBy(R.Eh(K.SV.eq)))}class Z{constructor(e){this._params=e,this._subs=new r.w,this._logger=o.Y.create("G2IntegrationGoogleDocs"),this._textFieldVisibleRect=s.h.create({top:0,left:0,width:0,height:0}),this._highlightCollectionFilterSource=new Y.b(this._params.textObserver),this._selectionRange=s.h.create(R.YP),this.name="g2-google-docs-integration",this.textFieldVisibleRect=this._textFieldVisibleRect.view(),this.highlightGeometryFilter=this._highlightCollectionFilterSource.highlightsFilterFactory(),this.highlightGeometryInvalidator=this._textFieldVisibleRect.pipe(D.D((()=>this._params.textObserver.textMapChanged))),this.selectionRange=this._selectionRange.view(),this.sidelinePositioningStrategy=(0,W.vc)(this._params.textFieldElement)?{kind:"alignWithTextFieldLeftBoundary"}:{kind:"hardcodedLeftOffset",leftOffset:40},this.isEnabled=this._params.integrationInfo.integrationMode.view((e=>e===U.yj.write)),this.paragraphFilter=(0,J.ff)($),this._subs.add(m.aj([this._params.textFieldLayout.rect.changes.pipe(q.O(this._params.textFieldLayout.rect.getCurrent())),this._params.textFieldLayout.scroll.changes.pipe(q.O(this._params.textFieldLayout.scroll.getCurrent()))]).pipe(g.U((()=>{var e;const t=this._params.textFieldElement.getBoundingClientRect(),i={top:t.top,left:t.left,width:t.width,height:t.height},a=(0,V.Gg)(this._params.textFieldElement)||(0,V.g)(this._params.textFieldElement)||(0,L.Jj)(this._params.textFieldElement).document.documentElement,r=(0,W.iy)(this._params.textFieldElement);if(null!==r){const{left:t,width:n}=null!==(e=H.UL.getIntersection(i,r.getBoundingClientRect()))&&void 0!==e?e:i,s=H.UL.getIntersection({...i,left:t,width:n},a.getBoundingClientRect());return null!==s?s:(this._logger.warn("Failed to find intersection between the text field and its first scrollable ancestor. The resulting text field's visible rect may not be appropriate."),{...i,left:t,width:n})}{this._logger.warn("Failed to retrieve rendering canvas. The resulting text field's visible rect lateral boundaries may not be appropriate.");const e=H.UL.getIntersection(i,a.getBoundingClientRect());return null!==e?e:(this._logger.warn("Failed to find intersection between the text field and its first scrollable ancestor. The resulting text field's visible rect may not be appropriate."),i)}}))).subscribe(u.wW(this._textFieldVisibleRect))),this._subs.add(X(this._params.selectionSource.data.behavior.pipe(_.h(void 0)),this._params.selectionService).subscribe(u.wW(this._selectionRange)))}dispose(){this._subs.unsubscribe()}}var ee=i(64524),te=i(58322);const ie={[te.u.gmailCompose]:15,[te.u.gmailReply]:16,[te.u.gmailComposeStandalone]:15,[te.u.gmailComposeFullScreen]:15,[te.u.slackMessage]:2,[te.u.slackGenericQuill]:2,[te.u.slackThread]:2,[te.u.gDocsCanvas]:0,[te.u.gDocsComments]:0};const ae={[te.u.gmailReply]:{top:170,bottom:140}};var re=i(57724);class ne{constructor(e){var t;this._params=e,this._subs=new r.w,this._logger=o.Y.create("G2IntegrationGeneric"),this._textFieldVisibleRect=s.h.create({top:0,left:0,width:0,height:0}),this._selectionRange=s.h.create(R.YP),this.name="g2-generic-integration",this.textFieldVisibleRect=this._textFieldVisibleRect.view(),this.highlightGeometryFilter=re.qH.everything,this.highlightGeometryInvalidator=(0,re.WF)(this._params.textFieldLayout),this.selectionRange=this._selectionRange.view(),this.sidelinePositioningStrategy={kind:"alignWithTextFieldLeftBoundary"},this.isEnabled=s.h.create(!0),this.paragraphFilter=k.W8,this._viewPortOffsets=void 0!==this._params.getVerticalViewportOffsets?this._params.getVerticalViewportOffsets(this._params.integrationInfo.integrationName):(t=this._params.integrationInfo.integrationName,R.ij(ae[t])),this._subs.add(m.aj([this._params.textFieldLayout.visibleRect.changes.pipe(q.O(this._params.textFieldLayout.visibleRect.getCurrent())),this._params.textFieldLayout.scroll.changes.pipe(q.O(this._params.textFieldLayout.scroll.getCurrent()))]).pipe(g.U((([e])=>{const t={top:e.client.top,left:e.client.left,width:e.size.width,height:e.size.height},i=this._getLeftOffset(),{top:a,bottom:r}=(0,k.zG)(this._viewPortOffsets,R.fS((()=>({top:0,bottom:0}))));return this._getVisibleTextFieldRect(t,a,r,i)}))).subscribe((e=>{this._textFieldVisibleRect.set(e)}))),this._subs.add(X(b.R(this._params.textFieldElement.ownerDocument,"selectionchange").pipe(ee.b(100),_.h(void 0)),this._params.selectionService).subscribe(u.wW(this._selectionRange)))}_getVisibleTextFieldRect(e,t,i,a){if(this._params.integrationInfo.integrationName===te.u.gmailReply){const r=(0,L.Jj)(this._params.textFieldElement).document.documentElement.getBoundingClientRect(),n=H.UL.getIntersection(e,r);if(n||(this._params.telemetry.warn({message:"Failed to find intersection between the text field's visible layout rect and window rect. The resulting text field's visible rect may not be appropriate."}),this._logger.warn("Failed to find intersection between the text field's visible layout rect and window rect. The resulting text field's visible rect may not be appropriate.",{integrationName:this._params.integrationInfo.integrationName})),null===n)return{top:0,height:0,left:0,width:0};const s=n.top<t?t:n.top;return{top:s,height:n.height+n.top>r.height-i?r.height-i-s:n.height,left:n.left-a,width:n.width+a}}return{top:e.top+t,height:e.height-i,left:e.left-a,width:e.width+a}}_getLeftOffset(){return this._params.integrationInfo.integrationName in ie?function(e){return ie[e]}(this._params.integrationInfo.integrationName):(this._logger.debug(`No left offset defined for integration with name "${this._params.integrationInfo.integrationName}," defaulting to zero.`),0)}dispose(){this._subs.unsubscribe()}}var se=i(57312),le=i(22156),oe=i(32559),de=i(40860),ce=i(98102),he=i(24613),me=i(61031),ge=i(43177),ue=i(72552),pe=i(85694),fe=i(5852);const be=ge.S((e=>e.struct({kind:e.literal(pe.PU.Final)}))),we=ge.S((e=>e.intersect(be(e))(fe.WV(e)))),Se=ge.n(ue.Schemable)(we).is,ve=ge.n(ue.Schemable)(fe.a9).is;function ye(e){const t=(e=>{switch(e.kind){case"improve":return{kind:"default"};case"rephrase":return{kind:"rephrase"};case"shorten":return{kind:"other",actionId:{id:"VBarG2Shorter"}};case"friendly":return{kind:"other",actionId:{id:"VBarG2Friendly"}};case"formal":return{kind:"other",actionId:{id:"VBarG2Formal"}};case"customPrompt":return{kind:"userPrompt",prompt:e.prompt};default:(0,oe.L0)(e)}})(e.type);return{correlationId:e.id,kind:{...t},entrypoint:{family:"g2",name:pe.K0.VbarCard},args:{},metadata:{}}}var _e=i(83138);class Ce{constructor(e){this._params=e,this._subs=new r.w,this._logger=o.Y.create("RewriteServiceImpl"),this._relevantCapiMessages=this._params.checkingService.pipe(he.oA,S.w((e=>e.capiMessages)),p.h((0,le.Kg)(Se,ve))),this._cachedRewriteIdMap=new Map,this._cachedRewriteMap=new Map,this._subs.add(this._relevantCapiMessages.subscribe((e=>this._handleServerMessage(e))))}_handleServerMessage(e){ve(e)?(this._params.telemetry.warn({message:'Server message with result "failure" received.'}),this._handleErrorMessage(e)):Se(e)?(this._params.telemetry.infoOncePerMessage({message:'Server message with result "success" received.'}),this._handleRewriteResultMessage(e)):(0,oe.vE)(e)}_handleRewriteResultMessage(e){const t=this._cachedRewriteMap.get(e.correlationId);if(void 0===t)this._params.telemetry.warn({message:'Server message with result "success" and unknown correlation ID received.'}),this._logger.warn("Received a successful result with unknown correlation ID.",{resultSuccessMessage:e});else{const i={kind:"ready",id:t.get().id,type:t.get().type,text:t.get().text,textRange:t.get().textRange,title:e.explanation,rewriteText:e.rewrite,rewriteDiff:(0,k.zG)(_e.F.getDiff(t.get().text,e.rewrite),de.mapLeft((t=>this._logger.error("Failed to get diff for rewrite.",{error:t,newText:e.rewrite}))),R.Uo)};this._logger.debug("Received a successful result; updating rewrite.",{rewriteBefore:t.get(),rewriteAfter:i}),t.set(i)}}_handleErrorMessage(e){const t=this._cachedRewriteMap.get(e.correlationId);if(void 0===t)this._params.telemetry.warn({message:'Server message with result "failure" and unknown correlation ID received.'}),this._logger.warn("Received a failed result with unknown correlation ID.",{errorMessage:e});else{const i={kind:"error",id:t.get().id,type:t.get().type,text:t.get().text,textRange:t.get().textRange,errorReason:e.errorType.kind,errorDetails:e.details};this._logger.debug("Received a failed result; updating rewrite.",{rewriteBefore:t.get(),rewriteAfter:i}),t.set(i)}}async getRewrite(e,t,i,a=!0){const r=(0,me.Wu)(t),n=`${e.kind}-${i.start}-${i.end}-${r}`,l=this._cachedRewriteIdMap.get(n),o=void 0!==l?this._cachedRewriteMap.get(l):void 0,d="customPrompt"!==e.kind&&a&&void 0!==o&&"error"!==o.get().kind;if(d)return o;d||void 0===l||this._cachedRewriteMap.delete(l);const c=(0,ce.Z)();this._cachedRewriteIdMap.set(n,c);const h=s.h.create({kind:"loading",id:c,type:e,text:t,textRange:i});this._cachedRewriteMap.set(h.get().id,h);const m=this._params.checkingService.get();if(R.Wi(m))return this._params.telemetry.error({message:"Getting rewrite failed: Checking service not initialized."}),this._logger.error("Failed to get rewrite. Checking service not initialized yet."),h.modify((e=>({...e,kind:"error",errorReason:"Failed to communicate with server."}))),h;const g=ye(h.get());try{const e=await m.value.sendMessage("text_actions:invokeRewrite",g,!1,{kind:"scope",scope:{kind:"sessionText",rev:Number.MIN_SAFE_INTEGER,range:{start:h.get().textRange.start,end:h.get().textRange.end}}})();if(de.isLeft(e))throw e.left.message;return h}catch(e){return this._params.telemetry.error({message:'Getting rewrite failed: Sending "disposable_cheetah:invokeCommand" message to CAPI failed.',error:e}),this._logger.error("Failed to get rewrite. Error sending text_actions:invokeRewrite message to CAPI.",{error:e}),h.modify((e=>({...e,kind:"error",errorReason:"Failed to communicate with server."}))),h}}dispose(){this._subs.unsubscribe()}}const xe=a.lazy((()=>Promise.all([i.e(4057),i.e(4169),i.e(5924),i.e(274)]).then(i.bind(i,77314)).then((({SidelineCardWrapper:e})=>({default:e})))));var ke=i(12768);var Re=i(98361);function Ee(e,t,i,a){return(0,k.zG)(e.getSidelineTextInfo(i),R.UI((({text:e,textRange:i})=>Re.D(t.getRewrite(a,e,i)).pipe(y.q(1),S.w(k.yR),g.U(R.G)))),R.pF((()=>x.of(R.YP))))}var Fe=i(61442),Ie=i(9414);class Te{constructor(e){var t;this._params=e,this._subs=new r.w,this._logger=o.Y.create("SidelineCardViewModelImpl"),this._sidelineCardStateMap=new Map,this._selectedRewriteSubscriptionMap=new Map,this._customPromptRewriteSubscriptionMap=new Map,this._sidelineCard=s.h.create(R.YP),this._showFeedbackForm=s.h.create(!1),this.isFeedbackFormVisible=this._showFeedbackForm.view(),this.sidelineCard=this._sidelineCard.view(),this._subs.add((t=this._params.sidelineCollectionViewModel,m.aj([t.activeSideline,t.pinnedSideline]).pipe(ee.b(0),g.U((([e,t])=>(0,k.zG)(t,R.UI((e=>({sideline:e,isPinned:!0}))),R.wp((()=>(0,k.zG)(e,R.UI((e=>({sideline:e,isPinned:!1}))))))))),g.U(R.tS((({sideline:e,isPinned:i})=>(0,k.zG)(t.getSidelineReferenceElement(e.sequentialId),R.UI((t=>({sidelineId:e.id,sidelineSequentialId:e.sequentialId,isSidelinePinned:i,sidelineSignal:"paragraphSideline"===e.kind?e.signal:R.G("selection"),referenceElement:t}))))))))).subscribe(u.wW(this._sidelineCard)))}_getSidelineCardState(e){var t;return null!==(t=this._sidelineCardStateMap.get(e.sidelineSequentialId))&&void 0!==t?t:this._initSidelineCardState(e)}_initSidelineCardState(e){const t=s.h.create({selectedRewriteType:{kind:"improve"},improveRewriteInfo:R.G({type:{kind:"improve"},kind:"idle"}),rephraseRewriteInfo:R.G({type:{kind:"rephrase"},kind:"idle"}),shortenRewriteInfo:R.YP,friendlyRewriteInfo:R.YP,formalRewriteInfo:R.YP,customPromptRewriteInfo:R.YP,rewriteApplied:!1,rewriteCopied:!1});return this._sidelineCardStateMap.set(e.sidelineSequentialId,t),t}_setRewriteInfo(e,t,i){const a=this._getSidelineCardState(i);switch(e.kind){case"improve":a.lens("improveRewriteInfo").set(t);break;case"rephrase":a.lens("rephraseRewriteInfo").set(t);break;case"shorten":a.lens("shortenRewriteInfo").set(t);break;case"friendly":a.lens("friendlyRewriteInfo").set(t);break;case"formal":a.lens("formalRewriteInfo").set(t);break;case"customPrompt":a.lens("customPromptRewriteInfo").set(t);break;default:(0,oe.L0)(e)}}_showAllRewriteTypes(e){this._setRewriteInfo({kind:"shorten"},R.G({type:{kind:"shorten"},kind:"idle"}),e),this._setRewriteInfo({kind:"friendly"},R.G({type:{kind:"friendly"},kind:"idle"}),e),this._setRewriteInfo({kind:"formal"},R.G({type:{kind:"formal"},kind:"idle"}),e)}_trackGnarEvent(e,t,i){const a=M(t.sidelineSignal);this._logger.debug(i,{sidelineId:t.sidelineId,gnarSidelineType:a}),e(t.sidelineId,a)}getSidelineCardState(e){return this._getSidelineCardState(e)}activateSidelineCard(e,t){this._params.sidelineCollectionViewModel.notifySidelineCardActive(e.sidelineSequentialId,t)}deactivateSidelineCard(e,t){(!e.isSidelinePinned||e.isSidelinePinned&&t)&&this._params.sidelineCollectionViewModel.notifySidelineCardInactive(e.sidelineSequentialId)}applyRewrite(e,t){this._logger.debug("Apply rewrite.",{rewrite:e,sidelineCard:t}),this._trackGnarEvent(this._params.gnar.vBarCardRewriteApply,t,"Tracking vBarCardRewriteApply gnar event."),this._params.getG2TrackingClient().g2ApplyRewrite(t.sidelineId,"insert"),this._params.performReplacement({pos:e.textRange,value:e.rewriteText,oldValue:e.text},{sidelineType:M(t.sidelineSignal)}).then((()=>this._params.telemetry.info({message:"Applying rewrite succeeded."}))).catch((e=>this._params.telemetry.error({message:"Applying rewrite failed.",error:e}))),this._getSidelineCardState(t).lens("rewriteApplied").set(!0),this._params.sidelineCollectionViewModel.notifySidelineCardInactive(t.sidelineSequentialId,!0)}async copyRewrite(e,t){this._logger.debug("Copy rewrite.",{rewrite:e,sidelineCard:t}),this._trackGnarEvent(this._params.gnar.vBarCardRewriteCopy,t,"Tracking vBarCardRewriteCopy gnar event."),this._params.getG2TrackingClient().g2CopyRewrite(t.sidelineId,"copy");try{await(0,Fe.vQ)(e.rewriteText),this._params.telemetry.info({message:"Copying rewrite succeeded."})}catch(e){this._params.telemetry.error({message:"Copying rewrite failed.",error:e}),this._logger.error("Failed to copy rewrite.",e)}this._getSidelineCardState(t).lens("rewriteCopied").set(!0)}submitCustomPrompt(e,t){var i;const a={kind:"customPrompt",prompt:e};null===(i=this._customPromptRewriteSubscriptionMap.get(t.sidelineSequentialId))||void 0===i||i.unsubscribe();const r=Ee(this._params.sidelineCollectionViewModel,this._params.rewriteService,t.sidelineSequentialId,a).subscribe((e=>this._setRewriteInfo(a,e,t)));this._subs.add(r)}notifySelectedRewriteTypeChanged(e,t){(0,ke.L5)(e)&&this._showAllRewriteTypes(t),this._getSidelineCardState(t).lens("selectedRewriteType").set(e)}notifyCustomPromptChanged(e,t){this._getSidelineCardState(t).lens("customPromptRewriteInfo").set(R.YP)}notifyRewriteShown(e,t){this._trackGnarEvent(this._params.gnar.vBarCardLoaded,t,"Tracking vBarCardLoaded gnar event."),this._params.getG2TrackingClient().g2CardContentLoaded(t.sidelineId)}notifySidelineCardShown(e){var t;const i=this._initSidelineCardState(e);null===(t=this._selectedRewriteSubscriptionMap.get(e.sidelineSequentialId))||void 0===t||t.unsubscribe();const a=i.lens("selectedRewriteType").pipe(p.h((0,Ie.ff)(ke.J8)),S.w((t=>Ee(this._params.sidelineCollectionViewModel,this._params.rewriteService,e.sidelineSequentialId,t).pipe(g.U((e=>({rewriteType:t,rewrite:e}))))))).subscribe((({rewriteType:t,rewrite:i})=>this._setRewriteInfo(t,i,e)));this._selectedRewriteSubscriptionMap.set(e.sidelineSequentialId,a),this._trackGnarEvent(this._params.gnar.vBarCardShow,e,"Tracking vBarCardShow gnar event.")}notifySidelineCardClosed(e){const t=this._getSidelineCardState(e).lens("rewriteApplied").get();this._logger.debug(`Sideline card with id - ${e.sidelineId}, was closed because ${t?"rewrite was applied":"user unhover the card"}.`),t||this._params.gnar.vBarCardClose(e.sidelineId,M(e.sidelineSignal))}notifyMoreTabClicked(e){this._showAllRewriteTypes(e)}showFeedbackForm(){this._showFeedbackForm.set(!0)}hideFeedbackForm(){this._showFeedbackForm.set(!1)}dispose(){this._subs.unsubscribe()}}var Pe=i(46210);function Ge(e){let t=0,i=0;const a=[];for(;i<=e.length;)"\n"!==e.charAt(i)&&""!==e.charAt(i)||(t!==i&&a.push({start:t,end:i}),t=i+1),i++;return a}class Me{constructor(e){this._params=e,this._subs=new r.w,this._logger=o.Y.create("ParagraphCollectionServiceImpl"),this._paragraphs=s.h.create([]),this._paragraphById=new Map,this.paragraphs=this._paragraphs.view(),this._subs.add(this._params.textObserver.contentChanges.async.pipe(p.h((e=>!e.deltaChange.isEmpty)),ee.b(1e3),q.O(null),g.U((()=>{const e=this._params.textObserver.getCurrentTextMap().getPlainText();return{paragraphTextRanges:Ge(e),fullText:e}})),g.U((({paragraphTextRanges:e,fullText:t})=>{const i=e.map(((e,i)=>function(e,t,i){return{id:`g2-paragraph-${t.start}-${t.end}`,sequentialId:e,textRange:t,text:i.slice(t.start,t.end)}}(i,e,t)));return i.filter((e=>this._params.integration.paragraphFilter({paragraph:e,fullText:t})))}))).subscribe(u.wW(this._paragraphs))),this._subs.add(this._paragraphs.subscribe((e=>{this._paragraphById.clear();for(const t of e)this._paragraphById.set(t.id,t)}))),this._subs.add(this._paragraphs.subscribe((e=>this._logger.debug("Paragraphs updated.",e))))}getParagraphById(e){return R.ij(this._paragraphById.get(e))}dispose(){this._subs.unsubscribe()}}var Be=i(61840),Le=i(76553),Oe=i(50725),Ne=i(16237),Ae=i(61764);var ze=i(34761),De=i(20401);const qe=({viewportRect:{top:e}})=>e,He=({viewportRect:{top:e,height:t}})=>e+t,Ve=e=>{if(e.length<2)return e;const t=e.sort(((e,t)=>qe(e)-qe(t))),i=[];let a=0,r=1,n=0;for(;a<e.length;){const e=t[a],s=t[r];void 0===s||qe(s)>=He(e)?(0===n&&i.push(e),a=r,n=0):(He(s)<=He(e)||(a=r),n++),r++}return i};function Ue(e){return{highlightId:re.y$.Id.create(`g2-paragraph-highlight-${e.textRange.start}-${e.textRange.end}`),paragraphId:e.id,paragraphSequentialId:e.sequentialId,alertId:"",highlightColor:null,highlightDisplayFormat:null,highlightLiveliness:null}}class We{constructor(e){this._params=e,this._subs=new r.w,this._logger=o.Y.create("ParagraphHighlightCollectionViewModelImpl"),this._paragraphHighlights=s.h.create([]),this._emphasizedParagraphHighlight=s.h.create(R.YP),this.paragraphHighlights=this._paragraphHighlights.view(),this.emphasizedParagraphHighlight=this._emphasizedParagraphHighlight.view(),this._subs.add(this._params.paragraphCollectionService.paragraphs.subscribe((e=>{const t=Array.from(this._params.paragraphHighlightCollectionGeometry.geometry.get().keys());this._params.paragraphHighlightCollectionGeometry.removeHighlights(t);for(const t of e){const e=Ue(t);this._params.paragraphHighlightCollectionGeometry.addHighlight(e.highlightId,t.textRange,e)}}))),this._subs.add(m.aj([this._params.integration.textFieldVisibleRect,this._params.textFieldLayout.rect.changes.pipe(q.O(this._params.textFieldLayout.rect.getCurrent())),this._params.textFieldLayout.scroll.changes.pipe(q.O(this._params.textFieldLayout.scroll.getCurrent())),this._params.paragraphHighlightCollectionGeometry.geometry.view((e=>Array.from(e.values())))]).pipe(g.U((([e,t,i,a])=>{const r=a.reduce(((a,r)=>(0,k.zG)(function(e,t,i,a,r,n,s,l){return(0,k.zG)(R.ij((0,Ne.jr)(a)),R.UI((a=>{const o=(0,Ae.Z)({kind:"offsetPoint",...a},r,n),d="alignWithTextFieldLeftBoundary"===l.kind?o.left-s.left:l.leftOffset,c=s.left+s.width-o.right,h={top:o.top,left:o.left-d,width:o.width+d+c,height:o.height};return{id:e,paragraphId:t,sequentialId:i,textFieldRect:{top:a.top,left:a.left-d,width:a.width+d+c,height:a.height},viewportRect:h,isScrolledIntoView:H.UL.doesRectContain(s,h)}})))}(r.meta.highlightId.toString(),r.meta.paragraphId,r.meta.paragraphSequentialId,r.rects,t.client,i,e,this._params.integration.sidelinePositioningStrategy),R.g_((()=>(this._params.telemetry.warn({message:"Creating highlight for paragraph failed."}),this._logger.warn("Failed to create paragraph highlight from highlight geometry. Skipping.",r),a)),(e=>{const t=Math.min(e.viewportRect.left,a.minimumViewportRectLeft),i=Math.min(e.textFieldRect.left,a.minimumViewportRectLeft);return{paragraphHighlights:a.paragraphHighlights.concat(e),minimumViewportRectLeft:t,minimumTextFieldRectLeft:i}})))),{paragraphHighlights:[],minimumViewportRectLeft:Number.MAX_SAFE_INTEGER,minimumTextFieldRectLeft:Number.MAX_SAFE_INTEGER});return r.paragraphHighlights.map((e=>({...e,viewportRect:{...e.viewportRect,left:r.minimumViewportRectLeft,width:e.viewportRect.width+(e.viewportRect.left-r.minimumViewportRectLeft)},textFieldRect:{...e.textFieldRect,left:r.minimumTextFieldRectLeft,width:e.textFieldRect.width+(e.textFieldRect.left-r.minimumTextFieldRectLeft)}})))})),g.U(Ve),w.b((e=>this._logger.debug("Paragraph highlights updated.",e)))).subscribe(u.wW(this._paragraphHighlights))),this._subs.add(f.T(this._params.textFieldLayout.scroll.changes.pipe(_.h(R.YP)),this._params.mouseData.pipe(Be.U(Oe.S.hz30),v.skipBy(Le.Z.eq),g.U((({client:e,offset:t})=>{return i=this._paragraphHighlights.get(),a=e,r=t,n=this._params.textFieldElement,null!==a&&null!==r&&(0,ze._N)(a,n)?(0,k.zG)(i,De.Ew((e=>H.UL.contains(r,e.textFieldRect)))):R.YP;var i,a,r,n})))).subscribe(u.wW(this._emphasizedParagraphHighlight)))}dispose(){this._subs.unsubscribe()}}var Ye=i(12920),je=i(33229);class $e{constructor(e){this._params=e,this._subs=new r.w,this._logger=o.Y.create("SelectionHighlightViewModelImpl"),this._selectionHighlight=s.h.create(R.YP),this.selectionHighlight=this._selectionHighlight.view(),this._subs.add(this._params.integration.selectionRange.subscribe((e=>{this._logger.debug("Selection range changed, updating selection highlight geometry accordingly.",{selectionRange:e});const t=Array.from(this._params.selectionHighlightGeometry.geometry.get().keys());this._params.selectionHighlightGeometry.removeHighlights(t),(0,k.zG)(e,se.bw((e=>{const t=re.y$.Id.create(`g2-selection-highlight-${e.start}-${e.end}`);this._params.selectionHighlightGeometry.addHighlight(t,e,{highlightId:t,text:this._params.textObserver.getCurrentTextMap().getPlainText().slice(e.start,e.end),textRange:e,alertId:"",highlightColor:null,highlightDisplayFormat:null,highlightLiveliness:null})})))}))),this._subs.add(m.aj([this._params.integration.textFieldVisibleRect,this._params.textFieldLayout.rect.changes.pipe(q.O(this._params.textFieldLayout.rect.getCurrent())),this._params.textFieldLayout.scroll.changes.pipe(q.O(this._params.textFieldLayout.scroll.getCurrent())),this._params.selectionHighlightGeometry.geometry.view((e=>Array.from(e.values())))]).pipe(g.U((([e,t,i,a])=>(0,k.zG)(R.ij(a[0]),R.tS((a=>function(e,t,i,a,r){return(0,k.zG)(e,R.DT((e=>T(e.meta.text)>1)),R.tS((e=>(0,k.zG)((0,Ne.jr)(e.rects),R.ij,R.UI((n=>{const s=(0,Ae.Z)({kind:"offsetPoint",...n},t,i),l="alignWithTextFieldLeftBoundary"===r.kind?s.left-a.left:r.leftOffset,o=a.left+a.width-s.right,d={top:s.top,left:s.left-l,width:s.width+l+o,height:s.height};return{id:e.meta.highlightId.toString(),text:e.meta.text,textRange:e.meta.textRange,viewportRect:d,isScrolledIntoView:H.UL.doesRectContain(a,d)}}))))))}(a,t.client,i,e,this._params.integration.sidelinePositioningStrategy))),R.UI((e=>{const t=this._params.paragraphHighlightCollectionViewModel.paragraphHighlights.get()[0];return t?{...e,viewportRect:{...e.viewportRect,left:t.viewportRect.left,width:t.viewportRect.width}}:e})))))).subscribe(u.wW(this._selectionHighlight)))}dispose(){this._subs.unsubscribe()}}var Je=i(26726),Ke=i(75261),Qe=i(78826),Xe=i(39144);const Ze=(e,t,i,a,r)=>{const n=[];return{submitFeedback(s,l){e.feedbackSentButtonClick(JSON.stringify({message:l,domain:r}),"g2",s),a.sendFeedback({feedbackData:{score:s,message:l,domain:r},message:"Feedback submitted"}),n.push(t.enqueue("feedbackSubmitted").subscribe()),i()},dispose(){n.forEach((e=>e.unsubscribe()))}}};var et=i(4515);const tt=({submitFeedback:e,experimentClient:t})=>a.createElement("div",{style:{paddingTop:"12px"}},a.createElement(et.q,{withScore:!0,onSubmit:t=>e(t.score,t.text),title:a.createElement("span",null,"How do you like Grammarly?"),hideTextBoxTitle:!0,hideLogo:!0,hideDomainHelpText:!0,showPostSubmitScreen:!1,submitButtonKind:"primary",experimentClient:t}));var it=i(53162),at=i(97985),rt=i(84085);const nt={priority:at.P.Priority.low,timeout:at.P.DefaultTimeout,position:at.P.Position.bottomLeft,viewType:at.P.ViewType.standard};var st;!function(e){e.createFactory=function(){return{feedbackSubmitted:rt.r.createBuilder().build(nt)}}}(st||(st={}));class lt{constructor(e){this._params=e,this._subs=new r.w,this._logger=o.Y.create("G2FeatureImpl"),this._servicesAndViewModels=s.h.create(R.YP),this._integration="googleDocs"===this._params.integrationInfo.kind?new Z({integrationInfo:this._params.integrationInfo,textFieldLayout:this._params.textFieldLayout,textFieldElement:this._params.textFieldElement,textObserver:this._params.textObserver,selectionSource:this._params.selectionSource,selectionService:this._params.selectionService}):new ne({integrationInfo:this._params.integrationInfo,textFieldLayout:this._params.textFieldLayout,textFieldElement:this._params.textFieldElement,selectionService:this._params.selectionService,telemetry:this._params.telemetry}),this._replacementService=this._params.replacementServiceInjector.create(Pe.P.g2),this._logger.debug("G2 feature initialized.",this._params.integrationInfo),this._subs.add(this._integration.isEnabled.pipe(n.x()).subscribe((e=>{e?(this._logger.debug("G2 integration enabled, initializing services and VMs."),this._init()):(this._logger.debug("G2 integration disabled, disposing services and VMs."),this._disposeServicesAndViewModels())})))}_init(){const e=new Ce({checkingService:this._params.checkingService,telemetry:this._params.telemetry}),t=new Me({textObserver:this._params.textObserver,integration:this._integration}),i=new Ye.C(this._params.geometryProvider,this._params.geometryLayout,(()=>this._params.textObserver.getCurrentTextMap()),this._integration.highlightGeometryFilter,this._integration.highlightGeometryInvalidator,(0,je.m)(),!0,void 0,void 0,void 0,void 0,o.Y.create(`${lt.name}.ParagraphHighlightCollectionGeometry`)),a=new We({paragraphCollectionService:t,paragraphHighlightCollectionGeometry:i,textFieldLayout:this._params.textFieldLayout,mouseData:this._params.mouseData,textFieldElement:this._params.textFieldElement,integration:this._integration,telemetry:this._params.telemetry}),r=new Ye.C(this._params.geometryProvider,this._params.geometryLayout,(()=>this._params.textObserver.getCurrentTextMap()),this._integration.highlightGeometryFilter,this._integration.highlightGeometryInvalidator,(0,je.m)(),!0,void 0,void 0,void 0,void 0,o.Y.create(`${lt.name}.SelectionHighlightGeometry`)),n=new $e({selectionHighlightGeometry:r,textFieldLayout:this._params.textFieldLayout,textObserver:this._params.textObserver,integration:this._integration,paragraphHighlightCollectionViewModel:a}),s=new z({integrationName:this._params.integrationInfo.integrationName,paragraphCollectionService:t,paragraphHighlightCollectionViewModel:a,alerts:this._params.alertProcessor.alerts.state.view((e=>Object.values(e).filter(E.Nf).filter(l.S.isTransformJsonCapiAlert))),textObserver:this._params.textObserver,textFieldLayout:this._params.textFieldLayout,textFieldElement:this._params.textFieldElement,selectionHighlightViewModel:n,legacyAssistantOpenState:this._params.legacyAssistantOpenState,assistantState:this._params.assistantState,telemetry:this._params.telemetry,gnar:this._params.gnar,user:this._params.user}),d=new Te({rewriteService:e,sidelineCollectionViewModel:s,performReplacement:(e,t)=>this._replacementService.performReplacement(e,t),gnar:this._params.gnar,telemetry:this._params.telemetry,getG2TrackingClient:this._params.getG2TrackingClient});this._servicesAndViewModels.set(R.G({rewriteService:e,paragraphCollectionService:t,paragraphHighlightCollectionGeometry:i,paragraphHighlightCollectionViewModel:a,selectionHighlightGeometry:r,selectionHighlightViewModel:n,sidelineCollectionViewModel:s,sidelineCardViewModel:d}))}_disposeServicesAndViewModels(){(0,k.zG)(this._servicesAndViewModels.get(),se.bw((e=>{e.rewriteService.dispose(),e.paragraphCollectionService.dispose(),e.paragraphHighlightCollectionGeometry.dispose(),e.paragraphHighlightCollectionViewModel.dispose(),e.selectionHighlightGeometry.dispose(),e.selectionHighlightViewModel.dispose(),e.sidelineCollectionViewModel.dispose(),e.sidelineCardViewModel.dispose()})))}get paragraphHighlightsUI(){return this._servicesAndViewModels.view(R.UI((({paragraphHighlightCollectionViewModel:e})=>a.createElement(a.Suspense,{fallback:a.createElement(a.Fragment,null)},a.createElement(d,{paragraphHighlights:e.paragraphHighlights})))))}get sidelinesUI(){return this._servicesAndViewModels.view(R.UI((({sidelineCollectionViewModel:e})=>a.createElement(a.Suspense,{fallback:a.createElement(a.Fragment,null)},a.createElement(c,{paragraphSidelines:e.paragraphSidelines,pinnedSideline:e.pinnedSideline,activeSideline:e.activeSideline,emphasizedSideline:e.emphasizedSideline,shouldHideSidelines:e.shouldHideSidelines,selectionSideline:e.selectionSideline,telemetry:this._params.telemetry,onPinSideline:t=>e.pinSideline(t),onUnpinSideline:t=>e.unpinSideline(t),onActivateSideline:t=>e.activateSideline(t),onDeactivateSideline:t=>e.deactivateSideline(t),onMountSideline:(t,i)=>e.setSidelineReferenceElement(t,i)})))))}get sidelineCardUI(){return this._servicesAndViewModels.view(R.UI((({sidelineCardViewModel:e})=>a.createElement(a.Suspense,{fallback:a.createElement(a.Fragment,null)},a.createElement(xe,{sidelineCard:e.sidelineCard,getSidelineCardState:t=>e.getSidelineCardState(t),telemetry:this._params.telemetry,onActivateSidelineCard:(t,i)=>e.activateSidelineCard(t,i),onDeactivateSidelineCard:(t,i)=>e.deactivateSidelineCard(t,i),onChangeSelectedRewriteType:(t,i)=>e.notifySelectedRewriteTypeChanged(t,i),onApplyRewrite:(t,i)=>e.applyRewrite(t,i),onCopyRewrite:(t,i)=>e.copyRewrite(t,i),onMountRewrite:(t,i)=>e.notifyRewriteShown(t,i),onChangeCustomPrompt:(t,i)=>e.notifyCustomPromptChanged(t,i),onSubmitCustomPrompt:(t,i)=>e.submitCustomPrompt(t,i),onClickMoreTab:t=>e.notifyMoreTabClicked(t),onMount:t=>e.notifySidelineCardShown(t),onShowFeedbackForm:()=>e.showFeedbackForm(),isFeedbackFormVisible:e.isFeedbackFormVisible,feedbackForm:this.feedbackForm2(e),onUnmount:t=>e.notifySidelineCardClosed(t)})))))}get feedbackForm(){const e=new it.y(s.h.create([]),st.createFactory(),1,5e3),t=this._servicesAndViewModels.view(R.UI((({sidelineCardViewModel:e})=>e))).view(R.g_((()=>{}),k.yR)).get();return t?t.isFeedbackFormVisible.view((i=>R.G(a.createElement(Je.u_,{isOpen:i,onClose:()=>t.hideFeedbackForm(),dismissOnOutsideClick:!1,title:"",width:"small"},a.createElement(Je.u_.Body,null,a.createElement(tt,{submitFeedback:Ze(this._params.gnar,e,(()=>t.hideFeedbackForm()),this._params.telemetry,this._params.integrationInfo.domain).submitFeedback,experimentClient:(0,Xe.OB)().experimentClient})))))):s.h.create(R.YP)}feedbackForm2(e){const t=new it.y(s.h.create([]),st.createFactory(),1,5e3),i=()=>e.hideFeedbackForm();return a.createElement("div",{style:{padding:"18px"}},a.createElement("div",{style:{display:"flex",justifyContent:"end",flex:"flex-end"}},a.createElement(Ke.J,{icon:Qe.V,accessibilityLabel:"Close icon",onClick:i})),a.createElement(tt,{submitFeedback:Ze(this._params.gnar,t,i,this._params.telemetry,this._params.integrationInfo.domain).submitFeedback,experimentClient:(0,Xe.OB)().experimentClient}))}dispose(){this._disposeServicesAndViewModels(),this._integration.dispose(),this._subs.unsubscribe()}}},12768:(e,t,i)=>{var a,r,n;i.d(t,{J8:()=>o,L5:()=>l,es:()=>s}),function(e){e.is=function(e){return"improve"===e.kind}}(a||(a={})),function(e){e.is=function(e){return"rephrase"===e.kind}}(r||(r={})),function(e){e.is=function(e){return"customPrompt"===e.kind}}(n||(n={}));const s=a.is,l=r.is,o=n.is},1284:(e,t,i)=>{i.r(t),i.d(t,{ParagraphHighlightCollection:()=>s});var a=i(54281),r=i(68665),n=i(3511);const s=({paragraphHighlights:e})=>r.createElement(a.F.Fragment,null,e.view((e=>e.map((e=>r.createElement("div",{"data-testid":"grammarly-g2-paragraph-highlight",className:n.paragraphHighlight,key:e.id,style:{top:e.textFieldRect.top,left:e.textFieldRect.left,width:e.textFieldRect.width,height:e.textFieldRect.height}}))))))},77314:(e,t,i)=>{i.r(t),i.d(t,{SidelineCardWrapper:()=>oe});var a=i(54281),r=i(68665),n=i(89883),s=i(19543),l=i(57775);const o=({referenceElement:e,onMouseEnter:t,onMouseLeave:i,onFocus:a,onClickAway:o,children:d})=>{const[c,h]=r.useState(null),{styles:m,attributes:g,state:u}=(0,n.D)(e,c,{placement:"bottom-start",modifiers:[{name:"flip",options:{padding:{bottom:165}}}]});return r.createElement(l.d,{onClickAway:o},r.createElement("div",{"data-testid":"grammarly-g2-sideline-card-popper",role:"dialog","aria-label":"Suggested rewrite dialog",tabIndex:0,ref:h,style:m.popper,className:s.sidelineCardPopper,onMouseEnter:t,onMouseLeave:i,onFocus:a,...g.popper},d(null==u?void 0:u.placement)))};var d=i(32559),c=i(25205);const h=()=>r.createElement("div",{className:c.sidelineCardRewriteLoadingSkeleton,"data-testid":"grammarly-g2-sideline-card-rewrite-loading-skeleton"},r.createElement("div",{className:c.sidelineCardRewriteLoadingSkeletonSignal}),r.createElement("div",{className:c.sidelineCardRewriteLoadingSkeletonContent},r.createElement("div",{className:c.sidelineCardRewriteLoadingSkeletonContentTitle}),r.createElement("div",{className:c.sidelineCardRewriteLoadingSkeletonContentText},r.createElement("div",{className:c.sidelineCardRewriteLoadingSkeletonContentTextLine}),r.createElement("div",{className:c.sidelineCardRewriteLoadingSkeletonContentTextLine}),r.createElement("div",{className:c.sidelineCardRewriteLoadingSkeletonContentTextLine}))));var m=i(72336),g=i(75261),u=i(23455),p=i(94489),f=i(46717);const b=({title:e,text:t})=>r.createElement("div",{className:m.sidelineCardRewriteSuccess,"data-testid":"grammarly-g2-sideline-card-rewrite-success"},r.createElement("div",{className:m.sidelineCardRewriteSuccessMain,"data-testid":"grammarly-g2-sideline-card-rewrite-success-main"},r.createElement(g.J,{size:"small",accessibilityLabel:"",icon:u.j}),r.createElement("div",{className:m.sidelineCardRewriteSuccessMainContent,"data-testid":"grammarly-g2-sideline-card-rewrite-success-main-content"},r.createElement(p.x,{className:m.sidelineCardRewriteSuccessMainContentTitle,as:"strong",color:"brand-default",variant:"text-small"},e),r.createElement(p.x,{as:"p",variant:"text-small",color:"base-subdued"},t))),r.createElement("div",{className:m.sidelineCardRewriteSuccessFooter,"data-testid":"grammarly-g2-sideline-card-rewrite-success-footer"},r.createElement(g.J,{size:"small",icon:f.p,accessibilityLabel:"Grammarly logo"})));var w=i(19541),S=i(21577),v=i(33347),y=i(71056),_=i(95845),C=i(64953),x=i(11501);const k=e=>{const[t,i]=r.useState(!1),a=r.useRef(void 0),n=r.useCallback((()=>{void 0!==a.current&&(self.clearTimeout(a.current),a.current=void 0)}),[]);r.useEffect(n,[]);return r.createElement(y.k,{className:x.sidelineCardRewriteCopyButton},t&&r.createElement(y.k,{className:x.sidelineCardRewriteCopyButtonCopyConfirmation,bgColor:"background-base-default"},r.createElement(p.x,{as:"p",variant:"text-xsmall",color:"base-subdued"},"Copied")),r.createElement(_.h,{variant:"tertiary",accessibilityLabel:"Copy",icon:C.c,size:"small",onClick:async()=>{await e.onClick(),i(!0),n(),a.current=self.setTimeout((()=>{i(!1)}),3e3)}}))};var R=i(20401),E=i(83138),F=i(13058),I=i(36313);const T={color:I.I.Text.Brand.Default,background:"rgba(177, 240, 232, 0.6)",fontWeight:"bold"},P={color:"#696969",backgroundColor:"rgba(156, 156, 156, 0.2)",textDecoration:"line-through"},G={color:I.I.Text.Base.Default,backgroundColor:I.I.Background.Base.Default},M=({diff:e,displayDeletes:t})=>r.createElement("p",null,(0,F.zG)(e,R.Su(((e,i)=>(0,F.zG)(i,E.F.matchOperation({onDelete:i=>t?r.createElement(p.x,{as:"span",variant:"text-small",key:e,style:P},i):null,onInsert:t=>r.createElement(p.x,{as:"span",variant:"text-small",key:e,style:T},t),onRetain:t=>r.createElement(p.x,{as:"span",variant:"text-small",key:e,style:G},t)}))))));var B=i(25394),L=i(80223),O=i(90516);const N=({className:e,...t})=>r.createElement(v.z,{...(0,S.Sh)(O.sidelineCardButton,e),variant:"tertiary",size:"small",...t});function A(e){return"attention"===e?w.sidelineCardRewriteReadyContentTitleAttention:"writingCoach"===e?w.sidelineCardRewriteReadyContentTitleWritingCoach:w.sidelineCardRewriteReadyContentTitleDefault}const z=e=>{const[t,i]=r.useState(null);r.useEffect((()=>{e.telemetry.infoOncePerMessage({message:"Rendering sideline card succeeded."})}),[]);return L.P.useEffectOnDidMount(e.onMount),r.createElement("div",{className:w.sidelineCardRewriteReady,"data-testid":"grammarly-g2-sideline-card-rewrite-ready"},r.createElement("div",{...(0,S.Sh)(w.sidelineCardRewriteReadySignalBar,(n=e.signal,"attention"===n?w.sidelineCardRewriteReadySignalBarAttention:"writingCoach"===n?w.sidelineCardRewriteReadySignalBarWritingCoach:w.sidelineCardRewriteReadySignalBarDefault)),"data-testid":"grammarly-g2-sideline-card-rewrite-ready-signal"}),r.createElement("div",{className:w.sidelineCardRewriteReadyContainer,"data-testid":"grammarly-g2-sideline-card-rewrite-ready-container"},r.createElement("div",{className:(a=null==t?void 0:t.getBoundingClientRect().height,a&&a>=190?w.sidelineCardRewriteReadyContentScrollable:w.sidelineCardRewriteReadyContent),"data-testid":"grammarly-g2-sideline-card-rewrite-ready-content",ref:i},r.createElement(p.x,{...(0,S.Sh)(w.sidelineCardRewriteReadyContentTitle,A(e.signal)),as:"strong",variant:"text-small"},e.title),(0,F.zG)(e.diffProps,B.UI((e=>r.createElement(M,{key:"diff",diff:e.diff,displayDeletes:e.displayDeletes}))),B.fS((()=>r.createElement(p.x,{as:"p",variant:"text-small"},e.newText))))),r.createElement("div",{className:w.sidelineCardRewriteReadyContentToolbar,"data-testid":"grammarly-g2-sideline-card-rewrite-ready-content-toolbar"},r.createElement("div",{className:w.sidelineCardRewriteReadyContentToolbarLeft,"data-testid":"grammarly-g2-sideline-card-rewrite-ready-content-toolbar-left"},r.createElement(N,{text:"Accept",onClick:e.onApply,"data-testid":"grammarly-g2-sideline-card-rewrite-ready-content-apply-btn"})),r.createElement("div",{className:w.sidelineCardRewriteReadyContentToolbarRight,"data-testid":"grammarly-g2-sideline-card-rewrite-ready-content-toolbar-right"},r.createElement(v.z,{"data-testid":"grammarly-g2-sideline-feedback-btn",variant:"tertiary",text:"Feedback",onClick:()=>e.onShowFeedback()}),r.createElement(k,{onClick:e.onCopy}),r.createElement(g.J,{icon:f.p,accessibilityLabel:"Grammarly logo"})))));var a,n};var D=i(80047),q=i(58511);function H(e){return e?["Assistance unavailable",e]:["Couldnt generate ideas","Please wait a moment, then try again."]}const V=({errorDetails:e})=>r.createElement(y.k,{direction:"column",align:"center",gap:.5,padding:8,"data-testid":"grammarly-g2-sideline-card-rewrite-error"},r.createElement(g.J,{icon:D.F,size:"large",variant:"warning",accessibilityLabel:"","data-testid":"grammarly-g2-sideline-card-rewrite-error-icon"}),r.createElement(p.x,{as:"p",variant:"text-medium",color:"base-default",align:"center","data-testid":"grammarly-g2-sideline-card-rewrite-error-title"},(0,q.li)(H(e))),r.createElement(p.x,{as:"p",variant:"text-small",color:"base-subdued",align:"center","data-testid":"grammarly-g2-sideline-card-rewrite-error-subtitle"},(0,q.Yg)(H(e)))),U=e=>r.createElement("div",{role:"region","aria-live":"error"===e.kind?"assertive":"polite","aria-busy":"loading"===e.kind,"aria-label":W(e.kind),"data-testid":"grammarly-g2-sideline-card-rewrite"},(()=>{switch(e.kind){case"loading":return r.createElement(h,null);case"ready":return r.createElement(z,{signal:e.signal,title:e.title,newText:e.newText,diffProps:e.diffProps,telemetry:e.telemetry,onApply:e.onApply,onCopy:e.onCopy,onMount:e.onMount,onShowFeedback:e.onShowFeedback});case"success":return r.createElement(b,{title:e.title,text:e.text});case"error":return r.createElement(V,{errorDetails:e.errorDetails});default:(0,d.L0)(e)}})());function W(e){switch(e){case"loading":return"Loading suggested rewrite";case"ready":case"success":return"Suggested rewrite";case"error":return"An error occurred";default:(0,d.L0)(e)}}var Y=i(59696),j=i(23464),$=i(4994),J=i(50864),K=i(91104);const Q="",X="",Z=({customPromptRewriteInfo:e,suggestedCustomPrompts:t,recentCustomPrompts:i,onGoBack:a,onChange:n,onSubmit:s})=>{const[l,o]=r.useState(""),d=r.useCallback((()=>{const e=l.trim();e.length>0&&s(e)}),[l]),c=r.useCallback((e=>{0===l.length&&"Backspace"===e.key&&(e.preventDefault(),e.stopPropagation(),a())}),[l]);return r.createElement(y.k,{className:K.sidelineCardCustomPrompt,direction:"column","data-testid":"grammarly-g2-sideline-card-custom-prompt"},r.createElement(y.k,{className:K.sidelineCardCustomPromptInput,align:"center",gap:{column:3},padding:2},r.createElement(N,{onClick:a,accessibilityLabel:"Go back",text:X,"data-testid":"grammarly-g2-sideline-card-custom-prompt-back-button"}),r.createElement("form",{className:K.sidelineCardCustomPromptInputForm,onSubmit:e=>{e.preventDefault(),d()}},r.createElement("input",{autoFocus:!0,type:"text",className:K.sidelineCardCustomPromptInputField,"aria-label":"Enter your prompt",placeholder:"Enter your prompt",onChange:e=>{o(e.target.value),n(e.target.value.trim())},onKeyDown:c,"data-testid":"grammarly-g2-sideline-card-custom-prompt-input-field"}),r.createElement("input",{type:"submit",style:{display:"none"},"data-testid":"grammarly-g2-sideline-card-custom-prompt-input-form-submit"})),l.trim().length>0&&r.createElement(N,{onClick:()=>d(),text:"Submit",shortcut:Q})),e?r.createElement(U,{...e}):r.createElement(y.k,{className:K.sidelineCardCustomPromptSuggestedResults,direction:"column",gap:{row:2},padding:2},r.createElement(p.x,{as:"p",color:"base-subdued",variant:"text-xsmall",className:K.sidelineCardCustomPromptSuggestedResultsSubtitle},"Tell us how to change this text.",t.length>0?" Try ideas below:":""),t.map((e=>r.createElement(N,{key:e,className:K.sidelineCardCustomPromptSuggestedResultsOption,iconStart:$.p,text:e,accessibilityLabel:`Submit suggested prompt: ${e}`}))),i.length>0&&r.createElement(p.x,{as:"p",color:"base-subdued",variant:"text-xsmall",className:K.sidelineCardCustomPromptSuggestedResultsSubtitle},"Recent"),i.map((e=>r.createElement(N,{key:e,className:K.sidelineCardCustomPromptSuggestedResultsOption,iconStart:J.w,text:e,accessibilityLabel:`Submit recent prompt: ${e}`})))))};const ee=({shortenRewriteInfo:e,friendlyRewriteInfo:t,formalRewriteInfo:i,improveTabRef:a,onClickCustomPromptEntryPoint:n})=>r.createElement(j.m.TabList,{accessibilityLabel:"Type of rewrite",bottomBorder:"none"},r.createElement(j.m.Tab,{id:"improve",label:"Improve",ref:a}),r.createElement(j.m.Tab,{id:"rephrase",label:"Rephrase"}),!e&&!t&&!i&&r.createElement(j.m.Tab,{id:"more",label:"More"}),e&&r.createElement(j.m.Tab,{id:"shorten",label:"Shorten"}),t&&r.createElement(j.m.Tab,{id:"friendly",label:"Friendly"}),i&&r.createElement(j.m.Tab,{id:"formal",label:"Formal"}),r.createElement(N,{className:Y.sidelineCardCustomPromptEntryPoint,onClick:n,"data-testid":"grammarly-g2-sideline-card-custom-prompt-entry-point",text:"Enter your own...",accessibilityLabel:"Enter your own prompt"})),te=({improveRewriteInfo:e,rephraseRewriteInfo:t,shortenRewriteInfo:i,friendlyRewriteInfo:a,formalRewriteInfo:n})=>r.createElement(r.Fragment,null,r.createElement(j.m.Panel,{id:"improve"},r.createElement(U,{...e})),r.createElement(j.m.Panel,{id:"rephrase"},r.createElement(U,{...t})),i&&r.createElement(j.m.Panel,{id:"shorten"},r.createElement(U,{...i})),a&&r.createElement(j.m.Panel,{id:"friendly"},r.createElement(U,{...a})),n&&r.createElement(j.m.Panel,{id:"formal"},r.createElement(U,{...n}))),ie=({tabListPosition:e,improveRewriteInfo:t,rephraseRewriteInfo:i,shortenRewriteInfo:n,friendlyRewriteInfo:s,formalRewriteInfo:l,suggestedCustomPrompts:o,recentCustomPrompts:c,customPromptRewriteInfo:h,onChangeCustomPrompt:m,onSubmitCustomPrompt:g,onChangeSelectedRewriteType:u,onClickMoreTab:p,onMount:f,isFeedbackFormVisible:b,feedbackForm:w,onUnmount:S})=>{const[v,y]=r.useState({kind:"improve"}),[_,C]=r.useState({kind:"improve"}),x=r.useRef(null);r.useEffect((()=>u(_)),[_]),L.P.useEffectOnDidMount(f),L.P.useEffectOnWillUnmount(S);const k=r.createElement(ee,{shortenRewriteInfo:n,friendlyRewriteInfo:s,formalRewriteInfo:l,improveTabRef:x,onClickCustomPromptEntryPoint:()=>{y(_),C({kind:"customPrompt",prompt:""})}}),R=r.createElement(te,{improveRewriteInfo:t,rephraseRewriteInfo:i,shortenRewriteInfo:n,friendlyRewriteInfo:s,formalRewriteInfo:l});return r.createElement("div",{className:Y.sidelineCard,"data-testid":"grammarly-g2-sideline-card"},r.createElement(a.F.Fragment,null,b.view((t=>t?w:"customPrompt"===_.kind?r.createElement(Z,{suggestedCustomPrompts:null!=o?o:[],recentCustomPrompts:null!=c?c:[],customPromptRewriteInfo:h,onGoBack:()=>C(v),onChange:m,onSubmit:g}):r.createElement(j.m,{defaultSelectedTab:_.kind,onChange:e=>{var t;"more"===e?(p(),null===(t=x.current)||void 0===t||t.click()):C(function(e){switch(e){case"improve":return{kind:"improve"};case"rephrase":return{kind:"rephrase"};case"shorten":return{kind:"shorten"};case"friendly":return{kind:"friendly"};case"formal":return{kind:"formal"};default:(0,d.L0)(e)}}(e))}},"top"===e?k:R,r.createElement("div",{className:Y.sidelineCardHorizontalDivider}),"bottom"===e?k:R)))))};var ae=i(12768);const re=({show:e,transitionDurationMs:t=250,display:i="inline-block",children:a})=>{const[n,s]=r.useState(!1),[l,o]=r.useState(!1);r.useEffect((()=>{let i;s(!0),e||(i=self.setTimeout((()=>s(!1)),t)),o(!e);const a=self.setTimeout((()=>o(e)),0);return()=>[i,a].forEach(clearTimeout)}),[e]);const d={display:i,opacity:l?1:0,transition:`opacity ${t}ms`};return n&&a?r.createElement("div",{style:d,"data-testid":"wrapper"},a):null};var ne=i(5314),se=i(45327),le=i(68896);const oe=({sidelineCard:e,telemetry:t,getSidelineCardState:i,onActivateSidelineCard:n,onDeactivateSidelineCard:s,onChangeSelectedRewriteType:l,onApplyRewrite:c,onCopyRewrite:h,onMountRewrite:m,onChangeCustomPrompt:g,onSubmitCustomPrompt:u,onClickMoreTab:p,onShowFeedbackForm:f,isFeedbackFormVisible:b,feedbackForm:w,onMount:S,onUnmount:v})=>{const y=(e,i)=>(0,F.zG)(e,B.UI((e=>function(e,t,i,a,r,n,s){return"loading"===e.kind||"idle"===e.kind?{kind:"loading"}:"ready"===e.kind?e.text===e.rewriteText?{kind:"success",title:"This text looks great!",text:"To rephrase your text, select another option."}:{kind:"ready",title:e.title,newText:e.rewriteText,diffProps:(0,F.zG)(e.rewriteDiff,B.UI((t=>({diff:t,displayDeletes:"improve"===e.type.kind})))),telemetry:s,signal:(0,F.zG)(t,B.hX((()=>(0,ae.es)(e.type))),B.hX((e=>"attention"===e||"writingCoach"===e)),B.FS),onApply:()=>i(e),onCopy:()=>a(e),onMount:()=>r(e),onShowFeedback:n}:"error"===e.kind?{kind:"error",errorDetails:e.errorDetails}:void(0,d.L0)(e)}(e,i.sidelineSignal,(e=>c(e,i)),(e=>h(e,i)),(e=>m(e,i)),(()=>{f()}),t))));return r.createElement(a.F.Fragment,null,e.pipe(ne.U(B.WG),se.O(null),le.G(),ne.U((([e,t])=>{const d=null!=t?t:e;return r.createElement(re,{show:null!==t,transitionDurationMs:150},d&&r.createElement(o,{referenceElement:d.referenceElement,onMouseEnter:()=>n(d,!1),onMouseLeave:()=>s(d,!1),onFocus:()=>n(d,!0),onClickAway:()=>s(d,!0)},(e=>r.createElement(a.F.Fragment,null,i(d).view((t=>r.createElement(ie,{tabListPosition:"bottom"===e||"bottom-end"===e||"bottom-start"===e?"top":"bottom",improveRewriteInfo:(0,F.zG)(y(t.improveRewriteInfo,d),B.pF((()=>({kind:"loading"})))),rephraseRewriteInfo:(0,F.zG)(y(t.rephraseRewriteInfo,d),B.pF((()=>({kind:"loading"})))),shortenRewriteInfo:(0,F.zG)(y(t.shortenRewriteInfo,d),B.pF(F.r5)),friendlyRewriteInfo:(0,F.zG)(y(t.friendlyRewriteInfo,d),B.pF(F.r5)),formalRewriteInfo:(0,F.zG)(y(t.formalRewriteInfo,d),B.pF(F.r5)),customPromptRewriteInfo:(0,F.zG)(y(t.customPromptRewriteInfo,d),B.pF(F.r5)),onChangeCustomPrompt:e=>g(e,d),onSubmitCustomPrompt:e=>u(e,d),onChangeSelectedRewriteType:e=>l(e,d),onClickMoreTab:()=>p(d),onMount:()=>S(d),onUnmount:()=>v(d),isFeedbackFormVisible:b,feedbackForm:w})))))))}))))}},69164:(e,t,i)=>{i.r(t),i.d(t,{SidelineCollection:()=>b});var a=i(25394),r=i(21577),n=i(54281),s=i(96031),l=i(13058),o=i(68665),d=i(59830),c=i(75261),h=i(75601),m=i(32559);const g=o.forwardRef((function({emphasized:e,signal:t,heightInPixels:i,onClick:a,onMouseOver:n,onMouseOut:s,onFocus:l,onBlur:g,telemetry:u},p){o.useEffect((()=>{u.infoOncePerMessage({message:"Rendering sideline succeeded."})}),[]);const f=("attention"===t||"loading"===t||"writingCoach"===t)&&!(e&&!(i>=24));return o.createElement("button",{"data-testid":"grammarly-g2-sideline",...(0,r.Sh)(d.sideline,e?d.sidelineEmphasized:d.sidelineIdle,"selection"===t?d.sidelineWithSelectionSignal:void 0,f?d.sidelineWithSignalBar:void 0),style:{height:i,width:16},disabled:!e,onClick:e?a:void 0,onFocus:e?l:void 0,onBlur:e?g:void 0,onMouseOver:n,onMouseOut:s,"aria-label":"See rewrite suggestions",ref:p},o.createElement("div",{...(0,r.Sh)(d.sidelineSignalBar,(e=>{switch(e){case"loading":return d.sidelineSignalBarLoading;case"attention":return d.sidelineSignalBarAttention;case"writingCoach":return d.sidelineSignalBarWritingCoach;case"selection":case void 0:return;default:(0,m.L0)(e)}})(t),e?d.sidelineSignalBarEmphasized:void 0,f?void 0:d.sidelineSignalBarHidden),role:"status","aria-label":"Rewrite suggestions available"}),o.createElement(c.J,{...(0,r.Sh)(d.sidelineArrow,e?d.sidelineArrowVisible:void 0,f?d.sidelineArrowBottom:void 0),icon:h.b,accessibilityLabel:"",size:"small",variant:"selection"===t?"inverse":"default"}))}));var u=i(50238),p=i(95019);const f=({sidelineSequentialId:e,isEmphasized:t,isActive:i,viewportRect:a,signal:n,telemetry:s,onPin:l,onUnpin:d,onActivate:c,onDeactivate:h,onMount:m})=>o.createElement(o.Fragment,null,o.createElement("span",{"data-testid":`grammarly-g2-sideline-paragraph-highlighter-${e}`,...(0,r.Sh)(p.sidelineParagraphHighlighter,i?p.sidelineParagraphHighlighterActive:void 0),style:{top:a.top-4,left:a.left-8-4,width:a.width+8+8,height:a.height+8},ref:t=>{t&&m(e,t)}}),o.createElement("span",{"data-testid":`grammarly-g2-sideline-positioner-${e}`,className:p.sidelinePositioner,style:{top:a.top,left:a.left-8}},o.createElement(g,{emphasized:i||t,signal:n,heightInPixels:a.height,onClick:()=>l(e),onFocus:()=>l(e),onBlur:()=>d(e),onMouseOver:()=>c(e),onMouseOut:()=>h(e),telemetry:s}))),b=({paragraphSidelines:e,pinnedSideline:t,activeSideline:i,emphasizedSideline:r,selectionSideline:d,shouldHideSidelines:c,telemetry:h,onPinSideline:m,onUnpinSideline:g,onActivateSideline:p,onDeactivateSideline:b,onMountSideline:w})=>{const S={telemetry:h,onPin:m,onUnpin:g,onActivate:p,onDeactivate:b,onMount:w};return o.createElement(n.F.Fragment,null,s.h.combine(e,t,i,r,d,c,((e,t,i,r,n,s)=>!s&&(0,l.zG)(t,a.UI((e=>o.createElement(f,{sidelineSequentialId:e.sequentialId,isEmphasized:!0,isActive:!0,viewportRect:(0,u.WE)(e)?e.paragraphHighlightViewportRect:e.selectionHighlightViewportRect,signal:(0,u.WE)(e)?a.FS(e.signal):"selection",...S}))),a.wp((()=>(0,l.zG)(n,a.UI((e=>o.createElement(f,{sidelineSequentialId:e.sequentialId,isEmphasized:!0,isActive:(0,l.zG)(i,a.g_(l.jv,(t=>t.sequentialId===e.sequentialId))),viewportRect:e.selectionHighlightViewportRect,signal:"selection",...S})))))),a.fS((()=>o.createElement(o.Fragment,null,e.map((e=>o.createElement(o.Fragment,{key:e.id},o.createElement(f,{sidelineSequentialId:e.sequentialId,isEmphasized:(0,l.zG)(r,a.g_(l.jv,(t=>t.sequentialId===e.sequentialId))),isActive:(0,l.zG)(i,a.g_(l.jv,(t=>t.sequentialId===e.sequentialId))),viewportRect:e.paragraphHighlightViewportRect,signal:a.FS(e.signal),...S})))))))))))}},83138:(e,t,i)=>{i.d(t,{F:()=>a});var a,r=i(8e3),n=i(58511),s=i(40860),l=i(19966),o=i(13058),d=i(95907);!function(e){let t;e.getDiff=(e,t)=>(0,o.zG)(s.tryCatch((()=>{const i=new r.diff_match_patch,a=i.diff_main(e,t);return i.diff_cleanupSemantic(a),a}),s.toError),s.chain((0,o.ls)(l.nI,s.fromOption((()=>new Error("Diff is empty")))))),function(e){e[e.DELETE=-1]="DELETE",e[e.RETAIN=0]="RETAIN",e[e.INSERT=1]="INSERT"}(t=e.Operation||(e.Operation={})),e.matchOperation=function({onInsert:e,onDelete:i,onRetain:a}){return r=>{const s=(0,n.li)(r);switch(s){case t.INSERT:return e((0,n.Yg)(r));case t.DELETE:return i((0,n.Yg)(r));case t.RETAIN:return a((0,n.Yg)(r));default:(0,d.vE)(s)}}}}(a||(a={}))},50238:(e,t,i)=>{function a(e){return"paragraphSideline"===e.kind}function r(e){return"selectionSideline"===e.kind}i.d(t,{WE:()=>a,ZR:()=>n,iu:()=>r});const n=-1},8649:(e,t,i)=>{if(i.d(t,{LJ:()=>b,Nd:()=>l,Ov:()=>f,TW:()=>y,Ur:()=>o,Xs:()=>_,e$:()=>S,eg:()=>v,fN:()=>m,iy:()=>c,k6:()=>u,kh:()=>h,lW:()=>w,lz:()=>g,qg:()=>s,uj:()=>n,uz:()=>p,vc:()=>d}),3075==i.j)var a=i(23212);var r=i(84548);function n(e){const t=(0,a.Cq)(e.querySelector(r.XG),"text buffer iframe");return(0,a.Cq)(t.nodeType===Node.ELEMENT_NODE&&"IFRAME"===t.tagName?t.contentDocument:void 0,"text buffer iframe document")}function s(e){const t=l(e);return{width:t?t.offsetWidth-t.clientWidth:0,height:t?t.offsetHeight-t.clientHeight:0}}function l(e){return e.querySelector(r.Wp)}function o(e){return e.querySelector(r.Qy)}function d(e){return e.querySelector(r.yw)}function c(e){return e.querySelector(r.gv)}function h(e){return e.querySelectorAll(r.gH)}function m(e){return e.querySelector(r.gH)}function g(e){return Boolean(e.querySelector(r.gH))}function u(e){let t=e.querySelector(r.os);return t||(t=document.querySelector(r.gH)),t?t.getBoundingClientRect():null}const p=e=>!!e.querySelector(r.Lq);function f(e){return e.querySelector(r.$x)}function b(e){return null==e?void 0:e.querySelector(r.y1)}function w(e){const t=e.querySelector(r.f);return!!t&&t.offsetHeight>0}function S(e){return!!e.querySelector(`${r.jW}, ${r.F8}`)}function v(){const e=document.querySelector(r.d0),t=(null==e?void 0:e.classList.contains(r.uj))?"edit":void 0,i=(null==e?void 0:e.classList.contains(r._m))?"suggesting":void 0;return t||i||"other"}function y(e){return e.querySelector(r.QR)}function _(e){return e.querySelector(r.ij)}},84548:(e,t,i)=>{i.d(t,{$x:()=>s,F8:()=>u,Go:()=>r,Kt:()=>y,Lq:()=>d,QR:()=>E,Qy:()=>b,Vk:()=>_,Wp:()=>a,XG:()=>n,_m:()=>m,d0:()=>c,f:()=>o,gH:()=>f,gL:()=>C,gv:()=>p,ij:()=>R,j5:()=>v,jW:()=>g,lO:()=>k,os:()=>S,rx:()=>x,uj:()=>h,y1:()=>l,yw:()=>w});const a=".kix-appview-editor",r=".docos-input",n=".docs-texteventtarget-iframe",s=".kix-cursor",l=".kix-cursor-caret",o="#docs-revisions-sidebar",d='#docs-toolbar-mode-switcher[aria-label="Viewing mode"]',c="#docs-toolbar-mode-switcher",h="edit-mode",m="suggest-mode",g="#titlebar-mode-indicator-container .titlebar-request-access-button",u="#titlebar-mode-indicator-container .kix-titlebar-request-access-button",p=".kix-canvas-tile-content",f="canvas.kix-canvas-tile-content:not(.docs-ui-unprintable *)",b=".kix-rotatingtilemanager:not(.docs-ui-unprintable *)",w=".kix-page-paginated",S=".kix-page-paginated.canvas-first-page",v=".docs-horizontal-ruler",y=".docs-vertical-ruler",_="#fontSizeSelect input",C=".docs-ruler-background",x=".docs-ruler-background-inner",k=".docs-ruler-indent-first-line",R=".modal-dialog.docs-dialog .fatal-error-message",E='#docs-titlebar-share-client-button div[role="button"]'},75410:(e,t,i)=>{i.d(t,{$O:()=>a,Mx:()=>r,RO:()=>n,vW:()=>s});const a=String.fromCharCode(16),r=String.fromCharCode(17),n=String.fromCharCode(18),s=String.fromCharCode(28)},12201:(e,t,i)=>{i.d(t,{b:()=>l});var a=i(10980),r=i(140),n=i(57724),s=i(96031);class l{constructor(e){this._textObserver=e,this._mapChangedAtom=s.h.create([0,[]]),this._sub=new a.w,this.highlightsFilterFactory=()=>s.h.combine((0,r.u)(),this._mapChangedAtom,((e,t)=>{const i=this._textObserver.getCurrentTextMap();return{filter:t=>e.filter(t)&&(null!==i.getFragmentAtOffset(t.start)||null!==i.getFragmentAtOffset(t.end)||null!==i.getFragmentAtOffset(t.end-1)),type:n.qH.ChangeType.preserve}})),this._sub.add(this._textObserver.textMapChanged.subscribe((e=>{this._mapChangedAtom.modify((([t,i])=>[t+1,e]))})))}dispose(){this._sub.unsubscribe()}}},19656:(e,t,i)=>{i.d(t,{J:()=>c});var a=i(13058),r=i(68665),n=i(80223),s=i(24613),l=i(68910),o=i(21577),d=i(178);const c=({onChange:e,labelId:t,className:i,checkboxClassName:c,labelClassName:h,checked:m,children:g,disabled:u,useDS:p,dataGrammarlyPart:f="ui-kit-checkbox",tabIndex:b=0,onMount:w=a.Q1})=>{const[S,v]=r.useState(null!=m&&m);r.useEffect((()=>{v(Boolean(m))}),[m]);const y=t=>{t.preventDefault(),t.stopPropagation(),v(!S),null==e||e(!S)},{ref:_,onMount:C}=n.P.useElWatcher();return r.useEffect((()=>{const e=_.pipe(s.oA,l.b(w)).subscribe();return()=>e.unsubscribe()}),[]),r.createElement("div",{"data-grammarly-part":f,...(0,o.Sh)(d.checkboxContainer,i)},r.createElement("div",{...(0,o.Sh)(d.checkbox,c,S?d.checkboxChecked:null,p?d.checkboxDS:null),role:"checkbox","aria-checked":S,tabIndex:b,"aria-labelledby":t,onKeyDown:e=>{" "===e.key&&y(e)},onClick:u?a.Q1:y,ref:C},S?r.createElement("div",{className:d.checkboxCheckmark}):null),r.createElement("label",{id:t,onClick:y,className:h},g))}},8454:(e,t,i)=>{i.d(t,{z:()=>m});var a=i(68665),r=i(62943);const n=({children:e,style:t,dataGrammarlyPart:i="ui-kit-iframe",...n})=>{const[s,l]=a.useState(null),o=a.useCallback((e=>{var t,i;let a=null;"contentDocument"in e.target&&(a=null!==(i=null===(t=e.target.contentDocument)||void 0===t?void 0:t.body)&&void 0!==i?i:null),l(a),a&&(a.style.margin="0",a.style.height="100vh",a.style.overflowY="hidden")}),[]);return a.createElement("iframe",{...n,style:{border:"none",...t},onLoad:o,srcDoc:"<html><body></body></html>","data-grammarly-part":i},s&&(0,r.createPortal)(e,s))};var s=i(6121),l=i(93265),o=i.n(l),d=i(53516),c=i(21194);const h=({placeholder:e,ariaLabel:t,onChange:i})=>{const[r,n]=a.useState("");return a.useEffect((()=>{i(r)}),[r]),a.createElement(a.Fragment,null,a.createElement(s.b,null,o().__css),a.createElement("div",{role:"textbox",className:o().textBox,contentEditable:!0,onInput:e=>{n(e.target.innerText)},"data-placeholder":e,"aria-placeholder":e,"aria-label":t}))},m=({placeholder:e,onChange:t,ariaLabel:i,iframeTitle:r,className:s})=>(0,d.E)().experimentClient.isGateEnabled(c.K.CentralizeStopEventPropagation)?a.createElement("div",{className:s,style:{width:"100%",height:"128px",maxHeight:"inherit"}},a.createElement(h,{onChange:t,ariaLabel:i,placeholder:e})):a.createElement(n,{dataGrammarlyPart:"ui-kit-textbox",className:s,style:{width:"100%",height:"100%"},title:r},a.createElement(h,{onChange:t,ariaLabel:i,placeholder:e}))},4515:(e,t,i)=>{i.d(t,{q:()=>F});var a=i(68665),r=i(21194),n=i(21577),s=i(42713),l=i(14884);const o=({fixSubmitButtonOverflowBottomPadding:e,className:t,...i})=>a.createElement(a.Fragment,null,a.createElement(s.z,{...i,className:null!=t?t:l.feedbackFormSubmitButton},i.children),a.createElement(d,{isEnabled:e})),d=e=>e.isEnabled?a.createElement("div",{className:l.feedbackFormSubmitButtonFixOverflowBottomPadding},a.createElement("div",{className:l.feedbackFormSubmitButtonFixOverflowBottomPaddingChild})):null,c=e=>a.createElement("div",{"data-grammarly-part":"surveys-feedback-form-thank-you",...(0,n.Sh)(l.feedbackFormContainer,l.feedbackFormContainerAlignCenter)},a.createElement("div",{className:l.feedbackFormSuccessMessageTextContainer},a.createElement("div",{className:l.feedbackFormSuccessMessageIcon}),a.createElement("div",{className:l.feedbackFormSuccessMessageTitle},"Thank you!"),a.createElement("div",{className:l.feedbackFormSuccessMessageSubtitle},"Your feedback helps us improve.")),a.createElement(o,{type:"button",kind:"success",onClick:e.onClose},"Done"));var h=i(8454),m=i(95907),g=i(44621);const u=({options:e,onChange:t=(()=>null),ariaLabel:i,className:r})=>{const s=[],[l,o]=a.useState(null);a.useEffect((()=>{var i;null!==l&&(null===(i=s[l])||void 0===i||i.focus()),t(null!==l?e[l].value:null)}),[l]);const d=null!==l?e[l]:null;return a.createElement("div",{"data-grammarly-part":"ui-kit-radio-group",className:r},a.createElement("div",{className:g.radioGroup,role:"radiogroup","aria-label":i,onKeyDown:t=>{if(" "!==t.key||d){if("ArrowRight"===t.key||"ArrowDown"===t.key){t.preventDefault(),t.stopPropagation();o(((l||0)+1)%e.length)}else if("ArrowLeft"===t.key||"ArrowUp"===t.key){t.preventDefault(),t.stopPropagation();const i=(l||0)-1;o(i<0?e.length-1:i)}}else t.preventDefault(),t.stopPropagation(),o(0)}},e.map(((e,t)=>{const i=(null==d?void 0:d.value)===e.value,r=0===t;return a.createElement("div",{key:e.value,...(0,n.Sh)(g.radioGroupOption,i?g.radioGroupOptionSelected:null),role:"radio",tabIndex:i||r&&!d?0:-1,"aria-checked":i,onClick:e=>{e.preventDefault(),e.stopPropagation(),o(t)},ref:e=>s.push(e)},e.render())}))))};var p;!function(e){e.bad="bad",e.ok="ok",e.good="good"}(p||(p={}));var f=i(41103);const b=e=>{const t=[p.bad,p.ok,p.good];return e.isEnabled?a.createElement(a.Fragment,null,a.createElement(u,{ariaLabel:"Feedback Score",options:t.map((e=>({value:e,render:()=>a.createElement("div",{className:f.feedbackFormOption},a.createElement("div",{...(0,n.Sh)(f.feedbackFormOptionIcon,w(e))}),a.createElement("div",null,function(e){switch(e){case p.bad:return"I dislike it";case p.ok:return"Its OK";case p.good:return"I like it";default:(0,m.vE)(e)}}(e)))}))),onChange:e.onChange,...(0,n.Sh)(l.feedbackFormScore,e.compactDisplay&&l.compact)}),!e.hideTextBoxTitle&&a.createElement("div",{className:l.feedbackFormTextBoxTitle},"Anything we can improve?")):null};function w(e){switch(e){case p.bad:return f.feedbackFormOptionIconDisheartening;case p.ok:return f.feedbackFormOptionIconNeutral;case p.good:return f.feedbackFormOptionIconSmiling;default:(0,m.vE)(e)}}var S=i(51822);const v=e=>e.isEnabled?a.createElement(S.T,{type:"mini",size:26,className:l.feedbackFormLogoLine}):null,y=e=>{var t;if(!e.isEnabled)return null;const i=null!==(t=e.title)&&void 0!==t?t:a.createElement("span",null,"How do you like ",a.createElement("br",null)," Grammarly?");return a.createElement("h3",{...(0,n.Sh)(l.feedbackFormTitle,e.isCompact&&l.compact)},i)};var _=i(19656);const C=e=>e.domain?a.createElement(a.Fragment,null,e.withHelpText&&a.createElement("div",{className:l.feedbackFormShareDomainTitle},"Help improve Grammarly by sharing the domain youre on:"),a.createElement(_.J,{labelId:"feedback-form-share-domain-checkbox",onChange:e.onChange,className:l.feedbackFormShareDomainCheckbox},"Include the domain ",a.createElement("b",null,e.domain)," with my feedback")):null,x=e=>{var t,i,r;const[s,d]=a.useState(null),[c,m]=a.useState(""),[g,u]=a.useState(!1);return a.createElement("form",{"data-grammarly-part":"surveys-feedback-form-fields",...(0,n.Sh)(l.feedbackFormContainer,"center"===e.align&&l.feedbackFormContainerAlignCenter)},a.createElement("div",{className:l.feedbackFormFields},a.createElement(v,{isEnabled:!e.hideLogo}),a.createElement(y,{isEnabled:!e.hideTitle,title:e.title,isCompact:null!==(t=e.compactDisplay)&&void 0!==t&&t}),a.createElement(b,{isEnabled:e.withScore,compactDisplay:e.compactDisplay,hideTextBoxTitle:e.hideTextBoxTitle,onChange:d}),a.createElement(h.z,{onChange:m,placeholder:null!==(i=e.placeholderText)&&void 0!==i?i:"Your thoughts here",ariaLabel:"Feedback Text",iframeTitle:"Feedback text field",...(0,n.Sh)(l.feedbackFormTextBox,e.compactDisplay&&l.compact)}),a.createElement(C,{domain:e.domain,withHelpText:!e.hideDomainHelpText,onChange:u})),a.createElement(o,{type:"submit",kind:null!==(r=e.submitButtonKind)&&void 0!==r?r:"success",disabled:e.withScore?!s:!c,fixSubmitButtonOverflowBottomPadding:e.fixSubmitButtonOverflowBottomPadding,onClick:t=>{t.preventDefault();const i=g?e.domain:void 0;e.withScore&&s?e.onSubmit({score:s,text:c,domain:i}):!e.withScore&&c&&e.onSubmit({text:c,domain:i})}},"Submit"))};var k=i(1282);const R=({hideLogo:e=!1,align:t="center",fixSubmitButtonOverflowBottomPadding:i=!1,showPostSubmitScreen:r=!0,...n})=>{const[s,l]=a.useState(!1),o=s&&r;return a.createElement("div",{style:n.style,"data-grammarly-part":"surveys-feedback-form",role:"region","aria-label":"Provide feedback","aria-live":"polite"},o?a.createElement(c,{fixSubmitButtonOverflowBottomPadding:i,onClose:n.onClose}):a.createElement(x,{...n,hideLogo:e,align:t,fixSubmitButtonOverflowBottomPadding:i,onSubmit:e=>{n.withScore?((0,k.n8)(e),n.onSubmit(e)):((0,k.TY)(e),n.onSubmit(e)),l(!0)}}))},E=({hideLogo:e=!1,align:t="center",fixSubmitButtonOverflowBottomPadding:i=!1,...r})=>{var o;const d=[p.bad,p.ok,p.good],[c,m]=a.useState(null),[g,b]=a.useState(""),[w,S]=a.useState(!1),[y,C]=a.useState(!1);let x;return x=y&&!1!==r.showPostSubmitScreen?a.createElement("div",{"data-grammarly-part":"surveys-feedback-form-thank-you",...(0,n.Sh)(l.feedbackFormContainer,l.feedbackFormContainerAlignCenter)},a.createElement("div",{className:l.feedbackFormSuccessMessageTextContainer},a.createElement("div",{className:l.feedbackFormSuccessMessageIcon}),a.createElement("div",{className:l.feedbackFormSuccessMessageTitle},"Thank you!"),a.createElement("div",{className:l.feedbackFormSuccessMessageSubtitle},"Your feedback helps us improve.")),a.createElement(s.z,{className:l.feedbackFormSubmitButton,kind:"success",type:"submit",onClick:r.onClose},"Done"),i?a.createElement("div",{className:l.feedbackFormSubmitButtonFixOverflowBottomPadding},a.createElement("div",{className:l.feedbackFormSubmitButtonFixOverflowBottomPaddingChild})):null):a.createElement("div",{"data-grammarly-part":"surveys-feedback-form-fields",...(0,n.Sh)(l.feedbackFormContainer,"center"===t?l.feedbackFormContainerAlignCenter:null)},a.createElement("div",{className:l.feedbackFormFields},a.createElement(v,{isEnabled:!e}),r.hideTitle?null:a.createElement("div",{...(0,n.Sh)(l.feedbackFormTitle,r.compactDisplay?l.compact:null)},r.title||a.createElement("span",null,"How do you like ",a.createElement("br",null)," Grammarly?")),r.withScore?a.createElement(a.Fragment,null,a.createElement(u,{ariaLabel:"Feedback Score",options:d.map((e=>({value:e,render(){let t,i;return e===p.bad?(t=f.feedbackFormOptionIconDisheartening,i="I dislike it"):e===p.ok?(t=f.feedbackFormOptionIconNeutral,i="Its OK"):(t=t=f.feedbackFormOptionIconSmiling,i="I like it"),a.createElement("div",{className:f.feedbackFormOption},a.createElement("div",{...(0,n.Sh)(f.feedbackFormOptionIcon,t)}),a.createElement("div",null,i))}}))),onChange:m,...(0,n.Sh)(l.feedbackFormScore,r.compactDisplay?l.compact:null)}),r.hideTextBoxTitle?null:a.createElement("div",{className:l.feedbackFormTextBoxTitle},"Anything we can improve?")):null,a.createElement(h.z,{onChange:b,placeholder:r.placeholderText||"Your thoughts here",ariaLabel:"Feedback Text",...(0,n.Sh)(l.feedbackFormTextBox,r.compactDisplay?l.compact:null)}),r.domain?a.createElement(a.Fragment,null,r.hideDomainHelpText?null:a.createElement("div",{className:l.feedbackFormShareDomainTitle},"Help improve Grammarly by sharing the domain youre on:"),a.createElement(_.J,{labelId:"feedback-form-share-domain-checkbox",onChange:S,className:l.feedbackFormShareDomainCheckbox},"Include the domain ",a.createElement("b",null,r.domain)," with my feedback")):null),a.createElement(s.z,{className:l.feedbackFormSubmitButton,kind:null!==(o=r.submitButtonKind)&&void 0!==o?o:"success",type:"submit",disabled:r.withScore?!c:!g,onClick:()=>{var e,t;r.withScore&&c?(null===(e=r.onSubmit)||void 0===e||e.call(r,{score:c,text:g,domain:w?r.domain:void 0}),C(!0)):!r.withScore&&g&&(null===(t=r.onSubmit)||void 0===t||t.call(r,{text:g,domain:w?r.domain:void 0}),C(!0))}},"Submit"),i?a.createElement("div",{className:l.feedbackFormSubmitButtonFixOverflowBottomPadding},a.createElement("div",{className:l.feedbackFormSubmitButtonFixOverflowBottomPaddingChild})):null),a.createElement("div",{style:r.style,"data-grammarly-part":"surveys-feedback-form",role:"region","aria-label":"Provide feedback"},x)},F=({experimentClient:e,...t})=>e.isGateEnabled(r.K.ExtensionA11yKeyboardNavigation)?a.createElement(R,{...t}):a.createElement(E,{...t})},1282:(e,t,i)=>{function a(e){return"score"in e}function r(e){if(!a(e))throw new Error("Received unexpected feedback form data without score")}function n(e){if(a(e))throw new Error("Received unexpected feedback form data with score")}i.d(t,{TY:()=>n,dK:()=>a,n8:()=>r})},61442:(e,t,i)=>{i.d(t,{Sz:()=>n,vQ:()=>r});var a=i(40860);async function r(e,t=self){if(function(e=self){var t,i;return!!(null===(i=null===(t=e.navigator)||void 0===t?void 0:t.clipboard)||void 0===i?void 0:i.writeText)}(t))return t.navigator.clipboard.writeText(e);throw new Error("Clipboard API not supported")}function n(e,t=self){return r(e,t).then((()=>a.right(void 0))).catch((e=>a.left(e instanceof Error?e:new Error(String(e)))))}},61031:(e,t,i)=>{function a(e,t=0){return(t<<5)-t+(0|e)|0}function r(e,t=0){let i=t;for(const t of e)i=a(t.charCodeAt(0),i);return i}i.d(t,{Wu:()=>r,k3:()=>a})},64533:(e,t,i)=>{var a=i(67754),r=i(80186)(a);r.push([e.id,"._z3YOv-textBox{font-family:Inter,sans-serif;font-style:normal;font-weight:normal;color:#0e101a;font-size:14px;line-height:21px;font-feature-settings:'ss03' on;background:#f9faff;border:1px solid #e7e9f5;box-sizing:border-box;border-radius:4px;padding:10px 8px;overflow-y:auto;cursor:text;width:100%;height:100%;}._z3YOv-textBox:empty:before{font-feature-settings:'ss03' on;font-family:Inter,sans-serif;font-style:normal;font-weight:normal;color:#6d758d;font-size:14px;line-height:21px;content:attr(data-placeholder)}",""]),r.locals={textBox:"_z3YOv-textBox"},e.exports=r},59830:e=>{e.exports={sideline:"G2vdT",sidelineEmphasized:"tw3gA",sidelineWithSelectionSignal:"ikZS7",sidelineWithSignalBar:"gtUhG",sidelineSignalBar:"Pdlcn",sidelineSignalBarLoading:"ZhtAx",pulse:"PEPt4",sidelineSignalBarAttention:"xQocX",sidelineSignalBarWritingCoach:"O4JQp",sidelineSignalBarEmphasized:"_mi1U",sidelineSignalBarHidden:"BNKg6",sidelineArrow:"Ihuz1",sidelineArrowVisible:"gtlTF",sidelineArrowBottom:"PPzfY"}},59696:e=>{e.exports={sidelineCard:"KetZV",sidelineCardHorizontalDivider:"d96oB",sidelineCardCustomPromptEntryPoint:"USGAc"}},90516:e=>{e.exports={sidelineCardButton:"qFbmx"}},91104:e=>{e.exports={sidelineCardCustomPrompt:"LfX1e",sidelineCardCustomPromptInput:"RoTP_",sidelineCardCustomPromptInputForm:"B0peX",sidelineCardCustomPromptInputField:"SLnHC",sidelineCardCustomPromptSuggestedResults:"o_ldN",sidelineCardCustomPromptSuggestedResultsSubtitle:"eezEJ",sidelineCardCustomPromptSuggestedResultsOption:"FmvTD"}},19543:e=>{e.exports={sidelineCardPopper:"m2vlI"}},11501:e=>{e.exports={sidelineCardRewriteCopyButton:"_kIwY","5rem":"TE61X",sidelineCardRewriteCopyButtonCopyConfirmation:"eH5TV"}},25205:e=>{e.exports={sidelineCardRewriteLoadingSkeleton:"AZpqD",sidelineCardRewriteLoadingSkeletonSignal:"QmlkU",blink:"ME70b",sidelineCardRewriteLoadingSkeletonContent:"pCdaZ",sidelineCardRewriteLoadingSkeletonContentTitle:"njaNp",sidelineCardRewriteLoadingSkeletonContentText:"tFJmW",sidelineCardRewriteLoadingSkeletonContentTextLine:"CUydw"}},19541:e=>{e.exports={sidelineCardRewriteReady:"aC0Qq",sidelineCardRewriteReadySignalBar:"zv_Ws",sidelineCardRewriteReadySignalBarAttention:"oimfv",sidelineCardRewriteReadySignalBarWritingCoach:"OgCkm",sidelineCardRewriteReadySignalBarDefault:"GGpaV",sidelineCardRewriteReadyContainer:"JCAN0",sidelineCardRewriteReadyContentScrollable:"Cq6T4",sidelineCardRewriteReadyContent:"ANoVu",sidelineCardRewriteReadyContentTitle:"JruGr",sidelineCardRewriteReadyContentTitleAttention:"ncGgB",sidelineCardRewriteReadyContentTitleWritingCoach:"TNHGD",sidelineCardRewriteReadyContentTitleDefault:"FKJEV",sidelineCardRewriteReadyContentToolbar:"AkoCa",sidelineCardRewriteReadyContentToolbarLeft:"Fl51m",sidelineCardRewriteReadyContentToolbarRight:"UPwBp"}},72336:e=>{e.exports={sidelineCardRewriteSuccess:"qCfRi",sidelineCardRewriteSuccessMain:"EHpcl",sidelineCardRewriteSuccessMainContent:"YnX7U",sidelineCardRewriteSuccessMainContentTitle:"KYYEg",sidelineCardRewriteSuccessFooter:"mKGH0"}},3511:e=>{e.exports={paragraphHighlight:"GdUyo"}},95019:e=>{e.exports={sidelineParagraphHighlighter:"ch8Da",sidelineParagraphHighlighterActive:"x3IoY",sidelinePositioner:"lx6ct"}},178:e=>{e.exports={checkboxContainer:"Te37e",checkbox:"mFHkX",checkboxDS:"DdH2q",checkboxChecked:"JhHnz",checkboxCheckmark:"zShXt",spin:"tww6q"}},44621:e=>{e.exports={radioGroup:"KAzfW",radioGroupOption:"WkjDU",radioGroupOptionSelected:"onilo"}},14884:e=>{e.exports={feedbackFormContainer:"kjElf",feedbackFormContainerAlignCenter:"hkEx2",feedbackFormFields:"Ua5wJ",feedbackFormTitle:"GnQ_a",feedbackFormTextBoxTitle:"kWEW0",feedbackFormLogoLine:"osGQI",compact:"b7yYp",feedbackFormScore:"ZOSRK",feedbackFormTextBox:"l8New",feedbackFormShareDomainTitle:"Qbnj_",feedbackFormShareDomainCheckbox:"VBCx1",feedbackFormSubmitButton:"tYYGU",feedbackFormSubmitButtonFixOverflowBottomPadding:"Opd8X",feedbackFormSubmitButtonFixOverflowBottomPaddingChild:"QKLT7",feedbackFormSuccessMessageTextContainer:"ARBzt",feedbackFormSuccessMessageIcon:"kJIzg",feedbackFormSuccessMessageTitle:"iXQnf",feedbackFormSuccessMessageSubtitle:"Ydufo",spin:"Vv6WG"}},41103:e=>{e.exports={feedbackFormOption:"sp8vS",feedbackFormOptionIcon:"eH6DL",feedbackFormOptionIconDisheartening:"DhaWh",feedbackFormOptionIconNeutral:"BS_8d",feedbackFormOptionIconSmiling:"dUZNd",spin:"uouSO"}}}]);