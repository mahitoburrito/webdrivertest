var e={63949:e=>{e.exports={}}},s={};function t(n){var r=s[n];if(void 0!==r)return r.exports;var i=s[n]={exports:{}};return e[n](i,i.exports,t),i.exports}(()=>{var e;t(63949);class s{constructor(e,s){this._didReceiveReadyMessage=!1,this._onMessageListeners=[],this._pendingOutgoingMessages=[],this._onMessageFromAnySource=e=>{null!=e.source&&e.source===this._iframe.contentWindow&&this._onMessage(e)},this._flushPendingOutgoingMessages=()=>{if(this._didReceiveReadyMessage&&0!==this._pendingOutgoingMessages.length&&null!=this._iframe.contentWindow){for(const e of this._pendingOutgoingMessages)this._iframe.contentWindow.postMessage(e,this._iframeTargetOrigin);this._pendingOutgoingMessages.length=0}},this._iframe=e,this._trustedSrcURL=s,self.addEventListener("message",this._onMessageFromAnySource)}setSrcURL(e){this._trustedSrcURL=e}get _iframeTargetOrigin(){const e=new URL(this._iframe.src,self.location.href).toString();if(!this._trustedSrcURL||!this._trustedSrcURL.startsWith(e))throw new Error("Invalid iframe target origin");return e}_onMessage(e){this._didReceiveReadyMessage=!0,this._onMessageListeners.forEach((s=>s(e.data))),this._flushPendingOutgoingMessages()}postMessage(e){null!=this._iframe.contentWindow&&this._didReceiveReadyMessage?(this._flushPendingOutgoingMessages(),this._iframe.contentWindow.postMessage(e,this._iframeTargetOrigin)):this._pendingOutgoingMessages.push(e)}onMessage(e){this._onMessageListeners.push(e)}dispose(){self.removeEventListener("message",this._onMessageFromAnySource),this._onMessageListeners.length=0,this._pendingOutgoingMessages.length=0}}!function(e){e.postMessage="postMessage",e.setMessagePort="setMessagePort",e.setSource="setSource"}(e||(e={}));const n=["https://d3ttvzt45fz9bg.cloudfront.net","https://applet-bundles.grammarly.net"];const r={id:"0",type:"request",action:"ping",data:null};(function(){const t=void 0;try{const i=function(){const e=document.createElement("iframe");return e.style.border="none",e.style.width="100%",e.style.height="100%",e.allow="clipboard-read *; clipboard-write *",e}(),o=new s(i,"about:blank");document.body.appendChild(i);let a=null;const g=[],l=setInterval((()=>{var e;null===(e=i.contentWindow)||void 0===e||e.postMessage(r,"*")}),4);o.onMessage((e=>{clearInterval(l),null!=a?a.postMessage(e):g.push(e)}));const u=e=>{a=e,a.onmessage=()=>{null==t||t("unexpected incoming message from parent, use postMessage instead of message port")},a.onmessageerror=e=>{null==t||t("message port error",e)};for(const e of g)a.postMessage(e);return g.length=0,a};self.addEventListener("message",(s=>{if(null==self.parent||s.source!==self.parent)return;const r=function(e){const s=e.data;if(null!=s&&"object"==typeof s&&"string"==typeof s.type)return s}(s);if(null!=r)switch(r.type){case e.setSource:(function(e){try{const s=new URL(e).origin;return n.includes(s)}catch(e){return!1}})(r.url)&&(i.src=r.url,o.setSrcURL(r.url));break;case e.postMessage:o.postMessage(r.data);break;case e.setMessagePort:if(!(r.port instanceof MessagePort))return void(null==t||t("invalid message port",r.port));null!=a&&(null==t||t("message port already set, overriding")),u(r.port)}})),self.parent.postMessage(r,"*")}catch(e){null==t||t(e)}})()})();